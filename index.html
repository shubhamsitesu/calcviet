<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Schema.org markup for Organization -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "May-tinh.com",
        "alternateName": ["Máy Tính Online", "Máy Tính Việt Nam"],
        "url": "https://may-tinh.com",
        "logo": "https://may-tinh.com/logo.png",
        "image": "https://may-tinh.com/images/calculator-og.jpg",
        "description": "Nền tảng máy tính trực tuyến hàng đầu Việt Nam cung cấp các công cụ tính toán miễn phí",
        "address": {
            "@type": "PostalAddress",
            "streetAddress": "123 Đường Lê Lợi",
            "addressLocality": "Hà Nội",
            "postalCode": "100000",
            "addressCountry": "VN"
        },
        "geo": {
            "@type": "GeoCoordinates",
            "latitude": 21.028511,
            "longitude": 105.804817
        },
        "openingHours": "Mo-Su 00:00-23:59",
        "email": "contact@may-tinh.com",
        "serviceArea": {
            "@type": "Country",
            "name": "Việt Nam"
        },
        "areaServed": ["Hà Nội", "TP. Hồ Chí Minh", "Đà Nẵng", "Hải Phòng", "Cần Thơ", "Biên Hòa", "Nha Trang", "Buôn Ma Thuột", "Huế", "Vinh"],
        "sameAs": [
            "https://www.facebook.com/maytinhcom",
            "https://twitter.com/maytinhcom",
            "https://www.youtube.com/@maytinhcom"
        ],
        "hasOfferCatalog": {
            "@type": "OfferCatalog",
            "name": "Dịch vụ Máy Tính Online",
            "itemListElement": [
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Máy tính khoa học",
                        "description": "Công cụ tính toán khoa học với các hàm lượng giác, logarit, lũy thừa"
                    }
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Máy tính tài chính",
                        "description": "Công cụ tính lãi suất, vay vốn, đầu tư, tiết kiệm"
                    }
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Máy tính BMI",
                        "description": "Công cụ tính chỉ số khối cơ thể và đánh giá sức khỏe"
                    }
                }
            ]
        }
    }
    </script>
    
    <!-- Service Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Service",
        "serviceType": "Máy tính trực tuyến",
        "provider": {
            "@type": "Organization",
            "name": "May-tinh.com"
        },
        "areaServed": "Việt Nam",
        "serviceOutput": {
            "@type": "Thing",
            "name": "Kết quả tính toán chính xác"
        },
        "hasOfferCatalog": {
            "@type": "OfferCatalog",
            "name": "Dịch vụ Máy Tính Online",
            "itemListElement": [
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Máy tính cơ bản",
                        "description": "Công cụ tính toán cộng, trừ, nhân, chia, phần trăm"
                    }
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Máy tính chuyển đổi",
                        "description": "Chuyển đổi đơn vị đo lường, tiền tệ, nhiệt độ"
                    }
                }
            ]
        }
    }
    </script>
    
    <!-- WebSite Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "May-tinh.com",
        "alternateName": "Máy Tính Online",
        "url": "https://may-tinh.com",
        "description": "Nền tảng máy tính trực tuyến hàng đầu Việt Nam",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://may-tinh.com/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    
    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Trang chủ",
                "item": "https://may-tinh.com"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "Máy tính",
                "item": "https://may-tinh.com#calculator"
            },
            {
                "@type": "ListItem",
                "position": 3,
                "name": "Máy tính khoa học",
                "item": "https://may-tinh.com#scientific"
            }
        ]
    }
    </script>
    
    <!-- Canonical Link -->
    <link rel="canonical" href="https://may-tinh.com/" />
    
    <!-- Title Tag with Keywords -->
    <title>Máy Tính - Máy Tính Online Khoa Học, Điện Tử, Miễn Phí | May-tinh.com</title>
    
    <!-- Meta Description with Keywords -->
    <meta name="description" content="Máy tính online miễn phí, máy tính khoa học, máy tính điện tử cho học sinh. Máy tính đơn giản, chính xác, nhanh chóng. Dễ sử dụng trên mọi thiết bị. Máy Tính tốt nhất Việt Nam!" />
    
    <!-- Meta Keywords -->
    <meta name="keywords" content="máy tính, máy tính online, máy tính khoa học, máy tính điện tử, máy tính miễn phí, máy tính đơn giản, máy tính cho học sinh, may tinh, máy tính cơ bản, máy tính tài chính, máy tính bmi, máy tính chuyển đổi" />
    
    <!-- Author and Copyright -->
    <meta name="author" content="May-tinh.com" />
    <meta name="copyright" content="© 2023 May-tinh.com" />
    
    <!-- Robots Meta Tag -->
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    
    <!-- Language and Geo Targeting -->
    <meta name="content-language" content="vi" />
    <meta name="geo.region" content="VN" />
    <meta name="geo.placename" content="Việt Nam" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Máy Tính - Máy Tính Online Khoa Học, Điện Tử, Miễn Phí | May-tinh.com" />
    <meta property="og:description" content="Máy tính online miễn phí, máy tính khoa học, máy tính điện tử cho học sinh. Máy tính đơn giản, chính xác, nhanh chóng. Dễ sử dụng trên mọi thiết bị." />
    <meta property="og:url" content="https://may-tinh.com/" />
    <meta property="og:site_name" content="May-tinh.com" />
    <meta property="og:image" content="https://may-tinh.com/images/calculator-og.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:locale" content="vi_VN" />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Máy Tính - Máy Tính Online Khoa Học, Điện Tử, Miễn Phí | May-tinh.com" />
    <meta name="twitter:description" content="Máy tính online miễn phí, máy tính khoa học, máy tính điện tử cho học sinh. Máy tính đơn giản, chính xác, nhanh chóng. Dễ sử dụng trên mọi thiết bị." />
    <meta name="twitter:url" content="https://may-tinh.com/" />
    <meta name="twitter:image" content="https://may-tinh.com/images/calculator-og.jpg" />
    <meta name="twitter:site" content="@maytinhcom" />
    
    <!-- Favicon -->
    <link rel="icon" href="https://may-tinh.com/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="https://may-tinh.com/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="https://may-tinh.com/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="https://may-tinh.com/apple-touch-icon-114x114.png" />
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#4285f4" />
    <meta name="msapplication-TileColor" content="#4285f4" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet" />
    
    <!-- AdSense Automatic Code -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
         crossorigin="anonymous"></script>
    
    <style>
        :root {
            --primary-color: #4285f4; /* Google blue */
            --secondary-color: #34a853; /* Google green */
            --accent-color: #ea4335; /* Google red */
            --dark-color: #202124;
            --light-color: #f8f9fa;
            --gray-color: #5f6368;
            --light-gray: #dadce0;
            --white: #ffffff;
            --button-bg: #f1f3f4;
            --button-hover: #e8eaed;
            --function-bg: #e8f0fe;
            --function-hover: #d2e3fc;
            --operator-bg: #e8f0fe;
            --operator-hover: #d2e3fc;
            --equals-bg: #4285f4;
            --equals-hover: #3367d6;
            --clear-bg: #f8f9fa;
            --clear-hover: #f1f3f4;
            --clear-border: #dadce0;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
            color: var(--dark-color);
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Header Styles */
        .header {
            background-color: var(--white);
            box-shadow: 0 1px 2px 0 rgba(60,64,67,0.3), 0 1px 3px 1px rgba(60,64,67,0.15);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: var(--primary-color);
            font-size: 22px;
            font-weight: 500;
        }
        
        .logo i {
            margin-right: 10px;
            font-size: 24px;
            color: var(--primary-color);
        }
        
        .nav-links {
            display: flex;
            list-style: none;
        }
        
        .nav-links li {
            margin-left: 25px;
        }
        
        .nav-links a {
            text-decoration: none;
            color: var(--dark-color);
            font-weight: 500;
            font-size: 14px;
            transition: color 0.2s;
        }
        
        .nav-links a:hover {
            color: var(--primary-color);
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--dark-color);
        }
        
        /* Mobile Menu Styles */
        .mobile-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background-color: var(--white);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 999;
            padding: 15px 0;
        }
        
        .mobile-menu.active {
            display: block;
        }
        
        .mobile-menu-links {
            list-style: none;
            padding: 0 15px;
        }
        
        .mobile-menu-links li {
            margin-bottom: 15px;
        }
        
        .mobile-menu-links li:last-child {
            margin-bottom: 0;
        }
        
        .mobile-menu-links a {
            text-decoration: none;
            color: var(--dark-color);
            font-weight: 500;
            font-size: 16px;
            display: block;
            padding: 10px 15px;
            border-radius: 4px;
            transition: background-color 0.2s, color 0.2s;
        }
        
        .mobile-menu-links a:hover {
            background-color: var(--light-color);
            color: var(--primary-color);
        }
        
        /* Breadcrumbs - Reduced size */
        .breadcrumbs {
            background-color: var(--light-color);
            padding: 4px 0;       /* Reduced padding */
            font-size: 12px;      /* Smaller font size */
            line-height: 1.2;     /* Tighter line height */
        }
        
        .breadcrumbs a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        .breadcrumbs a:hover {
            text-decoration: underline;
        }
        
        .breadcrumbs .separator {
            margin: 0 5px;        /* Reduced margin */
            color: var(--gray-color);
        }
        
        /* Calculator Section - Reduced top padding */
        .calculator-section {
            padding: 30px 0;      /* Reduced top padding */
            background-color: var(--white);
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .section-title h1 {
            font-size: 32px;
            color: var(--dark-color);
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .section-title h2 {
            font-size: 28px;
            color: var(--dark-color);
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .section-title p {
            font-size: 16px;
            color: var(--gray-color);
            max-width: 700px;
            margin: 0 auto;
        }
        
        /* Calculator Styles */
        .calculator { 
            background: #ccc; 
            padding: 15px; 
            border-radius: 20px; 
            box-shadow: inset -3px -3px 7px #fff, inset 3px 3px 7px rgba(0,0,0,0.4); 
            width: 100%; 
            max-width: 800px; 
            margin: 0 auto; 
            position: relative; 
        }
        
        .calculator .header { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 10px; 
            align-items: center; 
            position: relative; 
            background: none;
            box-shadow: none;
        }
        
        #historyBtn { 
            background: transparent; 
            border: none; 
            cursor: pointer; 
            font-size: 24px; 
            color: #333; 
        }
        
        #modeToggle { 
            display: flex; 
            gap: 2px; 
        }
        
        #modeToggle button { 
            padding: 6px 12px; 
            border: none; 
            border-radius: 6px; 
            margin: 0 2px; 
            font-weight: bold; 
            cursor: pointer; 
            background: #aaa; 
            color: #000; 
            user-select: none; 
            position: relative; 
            z-index: 1; 
        }
        
        #modeToggle button.active { 
            background: #555; 
            color: #fff; 
        }
        
        .display-container { 
            background: #e6e6e6; 
            border-radius: 6px; 
            padding: 12px 20px; 
            margin-bottom: 15px; 
        }
        
        #expression { 
            font-size: 16px; 
            color: #666; 
            text-align: right; 
            min-height: 20px; 
            overflow-x: auto; 
            white-space: nowrap; 
            margin-bottom: 5px; 
        }
        
        #display {
  font-size: 26px;
  font-weight: bold;
  text-align: right;
  min-height: 35px;
  overflow-x: auto;
  white-space: nowrap;
  color: #111;
  outline: none;
  cursor: text;
  user-select: text;
  padding-top: 10px; /* Add this line */
}
        
        .buttons-container { 
            display: flex; 
            gap: 10px; 
        }
        
        .buttons, .sci-buttons { 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 10px; 
            margin-top: 10px; 
            flex: 1; 
        }
        
        .sci-buttons { 
            display: none; 
        }
        
        .calculator button { 
            background: #b0b0b0; 
            border: none; 
            padding: 10px 0; 
            font-size: 16px; 
            font-weight: bold; 
            border-radius: 6px; 
            color: #000; 
            height: 40px; 
            box-shadow: -2px -2px 4px #fff, 2px 2px 4px rgba(0, 0, 0, 0.4); 
            cursor: pointer; 
            user-select: none; 
            transition: background 0.2s, transform 0.1s; 
        }
        
        .calculator button:hover { 
            background: #a0a0a0; 
        }
        
        .calculator button:active { 
            background: #999; 
            transform: scale(0.97); 
        }
        
        .deg-rad { 
            grid-column: span 4; 
            display: flex; 
            justify-content: center; 
            gap: 15px; 
            margin-top: 5px; 
            user-select: none; 
        }
        
        .deg-rad label { 
            font-size: 14px; 
        }
        
        /* Enhanced Modal Styles */
        .modal-overlay { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100vw; 
            height: 100vh; 
            background: rgba(0,0,0,0.7); /* Darker background */
            display: none; 
            justify-content: center; 
            align-items: center; 
            z-index: 9999; /* Much higher z-index */
            padding: 20px; /* Add padding */
        }
        
        .modal-overlay.active { 
            display: flex; 
        }
        
        .modal { 
            background: #ffffff; /* Changed to white for better contrast */
            border-radius: 15px; 
            padding: 25px; /* Increased padding */
            width: 90%; 
            max-width: 400px; /* Increased max width */
            max-height: 80vh; /* Increased max height */
            overflow-y: auto; 
            position: relative; 
            z-index: 10000; /* Higher z-index */
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); /* Enhanced shadow */
            border: 1px solid #e0e0e0; /* Added border */
        }
        
        .modal h2 { 
            margin-top: 0; 
            text-align: center; 
            color: var(--primary-color); /* Changed color */
            font-size: 22px; /* Increased font size */
            margin-bottom: 20px; /* Increased margin */
            padding-bottom: 10px; /* Added padding */
            border-bottom: 1px solid #eee; /* Added border */
        }
        
        .history-item { 
            background: #f9f9f9; /* Lighter background */
            border-radius: 8px; 
            padding: 12px 15px; /* Increased padding */
            margin-bottom: 12px; /* Increased margin */
            font-family: 'Roboto', monospace; /* Changed font */
            cursor: pointer; 
            user-select: text; 
            transition: background 0.2s; 
            white-space: nowrap; 
            overflow-x: auto; 
            max-width: 100%; 
            border-left: 4px solid var(--primary-color); /* Added left border */
        }
        
        .history-item:hover { 
            background: #f0f7ff; /* Changed hover color */
        }
        
        .close-btn { 
            position: absolute; 
            top: 15px; 
            right: 15px; 
            background: transparent; 
            border: none; 
            font-size: 24px; 
            cursor: pointer; 
            color: #666; /* Changed color */
            width: 32px; /* Fixed width */
            height: 32px; /* Fixed height */
            display: flex; /* Added flex */
            align-items: center; /* Added align */
            justify-content: center; /* Added justify */
            border-radius: 50%; /* Added border radius */
            transition: background-color 0.2s; /* Added transition */
        }
        
        .close-btn:hover { 
            background: #f0f0f0; /* Added hover background */
            color: #333; /* Changed hover color */
        }
        
        .power-expr { 
            display: inline-block; 
            position: relative; 
            vertical-align: baseline; 
        }
        
        .power-expr .base { 
            display: inline-block; 
            vertical-align: baseline; 
        }
        
        .power-expr .exp { 
  font-size: 0.6em; 
  vertical-align: super; 
  line-height: 0; 
  position: relative; 
  top: -0.3em; 
  border: 1px solid #555; 
  padding: 0.1em 0.2em;      /* Added padding for better spacing */
  width: auto; 
  min-width: 0.8em;          /* Made the initial box smaller */
  height: auto; 
  min-height: 1.2em;
  display: inline-block;     /* Changed from flex to prevent centering */
  background-color: #f0f0f0;
  border-radius: 2px;
  margin-left: 2px;
  cursor: text;
}
        
        .power-expr .exp.typed {
  border: none;
  background: none;
  padding: 0;
  min-width: 0;
  /* The margin-left is now inherited and consistent */
}
        
        .exp-x-expr { 
            display: inline-block; 
            position: relative; 
            vertical-align: baseline; 
        }
        
        .exp-x-expr .base { 
            display: inline-block; 
            vertical-align: baseline; 
            font-style: italic;
        }
        
        .exp-x-expr .exp { 
  font-size: 0.6em; 
  vertical-align: super; 
  line-height: 0; 
  position: relative; 
  top: -0.3em; 
  border: 1px solid #555; 
  padding: 0.1em 0.2em;      /* Added padding for better spacing */
  width: auto; 
  min-width: 0.8em;          /* Made the initial box smaller */
  height: auto; 
  min-height: 1.2em;
  display: inline-block;     /* Changed from flex to prevent centering */
  background-color: #f0f0f0;
  border-radius: 2px;
  margin-left: 2px;
  cursor: text;
}
        .exp-x-expr .exp.typed {
  border: none;
  background: none;
  padding: 0;
  min-width: 0;
  /* The margin-left is now inherited and consistent */
}
        
        .history-power .base { 
            display: inline-block; 
            vertical-align: baseline; 
        }
        
        .history-power .exp { 
            font-size: 0.7em; 
            vertical-align: super; 
            line-height: 0; 
            position: relative; 
            top: -0.2em; 
        }
        
        /* Desktop layout - show both button sets */
        @media (min-width: 769px) {
            .calculator { max-width: 800px; }
            .buttons-container { display: flex; }
            .buttons { display: grid; }
            .sci-buttons { display: grid; }
            #modeToggle { display: none; } /* Hide mode toggle on desktop */
        }
        
        /* Mobile layout - keep current behavior */
        @media (max-width: 768px) {
            .calculator { max-width: 400px; }
            .buttons-container { display: block; }
            .sci-buttons { display: none; }
            #modeToggle { display: flex; } /* Show mode toggle on mobile */
            
            /* Enhanced mobile modal styles */
            .modal { 
                width: 95%; 
                max-width: 350px; 
                padding: 20px; 
            }
            
            .modal h2 { 
                font-size: 20px; 
                margin-bottom: 15px; 
            }
            
            .history-item { 
                padding: 10px 12px; 
                margin-bottom: 10px; 
                font-size: 14px; 
            }
        }
        
        @media (max-width: 480px) {
            .calculator { padding: 10px; }
            #display { font-size: 22px; min-height: 30px; }
            #expression { font-size: 14px; }
            .calculator button { font-size: 14px; height: 35px; }
            
            /* Further enhanced mobile modal styles */
            .modal { 
                width: 98%; 
                max-width: 320px; 
                padding: 15px; 
            }
            
            .modal h2 { 
                font-size: 18px; 
                margin-bottom: 12px; 
            }
            
            .history-item { 
                padding: 8px 10px; 
                margin-bottom: 8px; 
                font-size: 13px; 
            }
        }
        
        /* Summary Section */
        .summary-section {
            padding: 60px 0;
            background-color: var(--white);
        }
        
        .summary-content {
            font-size: 18px;
            line-height: 1.8;
            color: var(--dark-color);
        }
        
        .summary-content h3 {
            font-size: 24px;
            color: var(--primary-color);
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 500;
        }
        
        .summary-content p {
            margin-bottom: 20px;
        }
        
        .summary-content ul {
            margin-left: 20px;
            margin-bottom: 20px;
        }
        
        .summary-content li {
            margin-bottom: 10px;
        }
        
        /* Features Section */
        .features-section {
            padding: 60px 0;
            background-color: var(--light-color);
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
        }
        
        .feature-card {
            background-color: var(--white);
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .feature-icon {
            font-size: 40px;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .feature-card h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--dark-color);
            font-weight: 500;
        }
        
        .feature-card p {
            color: var(--gray-color);
            margin-bottom: 20px;
        }
        
        /* Calculators Section */
        .calculators-section {
            padding: 60px 0;
            background-color: var(--white);
        }
        
        .calculators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }
        
        .calculator-card {
            background-color: var(--white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid var(--light-gray);
        }
        
        .calculator-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .calculator-card-img {
            height: 160px;
            background-color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .calculator-card-img i {
            font-size: 60px;
            color: var(--white);
        }
        
        .calculator-card-body {
            padding: 20px;
        }
        
        .calculator-card h3 {
            font-size: 20px;
            margin-bottom: 10px;
            color: var(--dark-color);
            font-weight: 500;
        }
        
        .calculator-card p {
            color: var(--gray-color);
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .calculator-card a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
        }
        
        .calculator-card a i {
            margin-left: 5px;
        }
        
        /* Future Features Section */
        .future-features-section {
            padding: 60px 0;
            background-color: var(--light-color);
        }
        
        .future-features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .future-feature-card {
            background-color: var(--white);
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .future-feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .future-feature-icon {
            font-size: 40px;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .future-feature-card h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--dark-color);
            font-weight: 500;
        }
        
        .future-feature-card p {
            color: var(--gray-color);
            margin-bottom: 20px;
        }
        
        /* Blog Section */
        .blog-section {
            padding: 60px 0;
            background-color: var(--light-color);
        }
        
        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .blog-card {
            background-color: var(--white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .blog-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .blog-img {
            height: 200px;
            background-color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 18px;
            font-weight: 500;
        }
        
        .blog-body {
            padding: 25px;
        }
        
        .blog-date {
            font-size: 14px;
            color: var(--gray-color);
            margin-bottom: 10px;
        }
        
        .blog-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--dark-color);
            font-weight: 500;
        }
        
        .blog-excerpt {
            color: var(--gray-color);
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .blog-link {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
        }
        
        .blog-link i {
            margin-left: 5px;
        }
        
        /* FAQ Section */
        .faq-section {
            padding: 60px 0;
            background-color: var(--white);
        }
        
        .accordion {
            margin-top: 30px;
        }
        
        .accordion-item {
            border: none;
            border-radius: 0;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .accordion-header {
            border-radius: 0;
        }
        
        .accordion-button {
            background-color: var(--light-color);
            color: var(--dark-color);
            font-weight: 500;
            font-size: 16px;
            box-shadow: none;
            border-radius: 0;
        }
        
        .accordion-button:not(.collapsed) {
            background-color: var(--primary-color);
            color: var(--white);
        }
        
        .accordion-button:focus {
            box-shadow: none;
        }
        
        .accordion-button::after {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23202124'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e");
        }
        
        .accordion-button:not(.collapsed)::after {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23ffffff'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e");
        }
        
        .accordion-body {
            font-size: 16px;
            line-height: 1.6;
        }
        
        /* About Section */
        .about-section {
            padding: 60px 0;
            background-color: var(--light-color);
        }
        
        .about-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: center;
        }
        
        .about-text h3 {
            font-size: 28px;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .about-text p {
            margin-bottom: 20px;
            font-size: 16px;
            line-height: 1.7;
        }
        
        .about-img {
            background-color: var(--primary-color);
            height: 400px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 24px;
            font-weight: 500;
        }
        
        /* Ad Sections - For AdSense Auto Ads */
        .ad-section {
            padding: 30px 0;
            background-color: var(--light-color);
            text-align: center;
            overflow: hidden;
        }
        
        /* Footer */
        .footer {
            background-color: var(--dark-color);
            color: var(--white);
            padding: 50px 0 20px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-column h3 {
            font-size: 18px;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
            font-weight: 500;
        }
        
        .footer-column h3::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 50px;
            height: 3px;
            background-color: var(--primary-color);
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: #ddd;
            text-decoration: none;
            transition: color 0.2s;
            font-size: 14px;
        }
        
        .footer-links a:hover {
            color: var(--primary-color);
        }
        
        .social-links {
            display: flex;
            margin-top: 20px;
        }
        
        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            margin-right: 10px;
            transition: background-color 0.2s;
        }
        
        .social-links a:hover {
            background-color: var(--primary-color);
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
            color: #aaa;
        }
        
        /* Responsive Styles */
        @media (max-width: 992px) {
            .section-title h1 {
                font-size: 28px;
            }
            
            .section-title h2 {
                font-size: 24px;
            }
            
            .about-content {
                grid-template-columns: 1fr;
            }
            
            .about-img {
                height: 300px;
            }
        }
        
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .calculator-section, .summary-section, .features-section, .calculators-section, .future-features-section, .blog-section, .faq-section, .about-section {
                padding: 30px 0;
            }
            
            .about-content {
                gap: 30px;
            }
        }
        
        @media (max-width: 576px) {
            .section-title h1 {
                font-size: 24px;
            }
            
            .section-title h2 {
                font-size: 22px;
            }
            
            .feature-card, .calculator-card-body, .blog-body, .future-feature-card {
                padding: 20px;
            }
            
            .about-content {
                gap: 20px;
            }
        }
        html {
  scroll-behavior: smooth;
}
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <a href="https://may-tinh.com" class="logo">
                    <i class="fas fa-calculator"></i>
                    Máy Tính
                </a>
                <ul class="nav-links">
                    <li><a href="#home">Trang Chủ</a></li>
<li><a href="#blog">Blog</a></li>
<li><a href="#faq">FAQ</a></li>
<li><a href="#about">Về Chúng Tôi</a></li>
<li><a href="https://may-tinh.com/privacy-policy">Chính Sách Bảo Mật</a></li>
<li><a href="https://may-tinh.com/terms">Điều Khoản Sử Dụng</a></li>
<li><a href="https://may-tinh.com/contact">Liên Hệ</a></li>
                </ul>
                <button class="mobile-menu-btn" id="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
            <!-- Mobile Menu -->
            <div class="mobile-menu" id="mobile-menu">
                <ul class="mobile-menu-links">
                    <li><a href="#home">Trang Chủ</a></li>
<li><a href="#blog">Blog</a></li>
<li><a href="#faq">FAQ</a></li>
<li><a href="#about">Về Chúng Tôi</a></li>
<li><a href="https://may-tinh.com/privacy-policy">Chính Sách Bảo Mật</a></li>
<li><a href="https://may-tinh.com/terms">Điều Khoản Sử Dụng</a></li>
<li><a href="https://may-tinh.com/contact">Liên Hệ</a></li>
                </ul>
            </div>
        </div>
    </header>

    <!-- Breadcrumbs -->
    <div class="breadcrumbs">
        <div class="container">
            <a href="https://may-tinh.com">Trang chủ</a>
            <span class="separator">/</span>
            <span>Máy Tính Online</span>
        </div>
    </div>

    <!-- Calculator Section -->
    <section class="calculator-section" id="calculators">
        <div class="container">
            <div class="section-title">
                <h1>Máy Tính Online - Máy Tính Khoa Học, Điện Tử, Miễn Phí</h1>
                <p>Công cụ tính toán trực tuyến chính xác, nhanh chóng và dễ sử dụng cho mọi người Việt Nam</p>
            </div>
            
            <div class="calculator">
              <div class="header">
                <button id="historyBtn" title="Lịch sử">📜</button>
                <div id="modeToggle">
                  <button id="basicBtn" class="active" title="Chế độ cơ bản">Cơ bản</button>
                  <button id="sciBtn" title="Chế độ khoa học">Khoa học</button>
                </div>
              </div>
              <div class="display-container">
                <div id="expression" aria-label="Biểu thức hiển thị"></div>
                <div id="display" contenteditable="true" spellcheck="false" inputmode="none" aria-label="Màn hình máy tính">0</div>
              </div>
              <div class="deg-rad">
                <label><input type="radio" name="angleMode" value="deg" checked> Độ</label>
                <label><input type="radio" name="angleMode" value="rad"> Rad</label>
              </div>
              <div class="buttons-container">
                <div class="sci-buttons" id="sciButtons">
                  <button onclick="insertFunction('sin')">sin</button>
                  <button onclick="insertFunction('cos')">cos</button>
                  <button onclick="insertFunction('tan')">tan</button>
                  <button onclick="insertRoot()">√</button>
                  <button onclick="insertFunction('asin')">sin⁻¹</button>
                  <button onclick="insertFunction('acos')">cos⁻¹</button>
                  <button onclick="insertFunction('atan')">tan⁻¹</button>
                  <button onclick="insertCubeRoot()">³√</button>
                  <button onclick="insertFunction('log')">log</button>
                  <button onclick="insertFunction('ln')">ln</button>
                  <button onclick="applySciFunc('inverse')">1/x</button>
                  <button onclick="insertSquare()">x²</button>
                  <button onclick="insertChar('π')">π</button>
                  <button onclick="insertChar('e')">e</button>
                  <button onclick="insertFactorial()">n!</button>
                   <button onclick="insertCube()">x³</button>
                  <button onclick="insertEXPX()">e^x</button>
                  <button onclick="applySciFunc('abs')">|x|</button>
                  <button onclick="insertScientificNotation()">EXP</button>
                  <button onclick="insertPower()" title="Lũy thừa với số hiện tại">xʸ</button>
                </div>
                <div class="buttons" id="basicButtons">
                  <button onclick="insertChar('(')">(</button>
                  <button onclick="insertChar(')')">)</button>
                  <button onclick="insertChar('/')">÷</button>
                  <button id="acBackspaceBtn" onclick="toggleACBackspace()">AC</button>
                  <button onclick="insertChar('7')">7</button>
                  <button onclick="insertChar('8')">8</button>
                  <button onclick="insertChar('9')">9</button>
                  <button onclick="insertChar('+')">+</button>
                  <button onclick="insertChar('4')">4</button>
                  <button onclick="insertChar('5')">5</button>
                  <button onclick="insertChar('6')">6</button>
                  <button onclick="insertChar('-')">-</button>
                  <button onclick="insertChar('1')">1</button>
                  <button onclick="insertChar('2')">2</button>
                  <button onclick="insertChar('3')">3</button>
                  <button onclick="insertChar('*')">×</button>
                  <button onclick="insertChar('%')" title="Phần trăm">%</button>
                  <button onclick="insertChar('0')">0</button>
                  <button onclick="insertChar('.')">.</button>
                  <button onclick="calculate()">=</button>
                </div>
              </div>
            </div>
        </div>
    </section>

    
    <!-- Summary Section -->
    <section class="summary-section" id="summary">
        <div class="container">
            <div class="section-title">
                <h2>Tất Cả Về Máy Tính Online</h2>
                <p>Khám phá thế giới tính toán trực tuyến với máy tính của chúng tôi</p>
            </div>
            
            <div class="summary-content">
                <h3>Máy Tính Online - Giải Pháp Tính Toán Toàn Diện</h3>
                <p>Trong thời đại công nghệ số hiện nay, việc có một công cụ <strong>máy tính</strong> đáng tin cậy và dễ tiếp cận là nhu cầu thiết yếu của mọi người. <strong>Máy tính online</strong> tại May-tinh.com được thiết kế để đáp ứng nhu cầu đó, mang đến một nền tảng tính toán trực tuyến hoàn toàn miễn phí, chính xác và dễ sử dụng cho mọi người Việt Nam.</p>
                
                <p><strong>Máy tính</strong> của chúng tôi không chỉ là một công cụ đơn giản thực hiện các phép tính cơ bản, mà còn là một giải pháp toàn diện với nhiều tính năng nâng cao. Từ <strong>máy tính cơ bản</strong> cho các phép tính cộng, trừ, nhân, chia, đến <strong>máy tính khoa học</strong> với các hàm lượng giác, logarit, lũy thừa, tất cả đều được tích hợp trong một giao diện thân thiện và trực quan.</p>
                
                <p>Điểm đặc biệt của <strong>máy tính online</strong> của chúng tôi là khả năng truy cập từ mọi thiết bị có kết nối internet. Bạn không cần phải cài đặt bất kỳ phần mềm nào hay lo lắng về việc máy tính của mình có đủ cấu hình để chạy các ứng dụng nặng. Chỉ cần mở trình duyệt web và truy cập May-tinh.com, bạn đã có ngay một công cụ tính toán mạnh mẽ trong tay.</p>
                
                <h3>Lịch Sử Phát Triển Của Máy Tính</h3>
                <p><strong>Máy tính</strong> đã trải qua một hành trình phát triển ấn tượng từ những công cụ cơ bản nhất đến các siêu <strong>máy tính điện tử</strong> hiện đại. Khởi đầu với những vật dụng đếm đơn giản như ngón tay, viên sỏi, cây gậy, con người đã phát minh ra bàn tính cổ đại (abacus) ở Trung Quốc khoảng 2400 năm trước Công nguyên. Đây được coi là tổ tiên của <strong>máy tính</strong> hiện đại, cho phép thực hiện các phép tính cộng, trừ một cách nhanh chóng.</p>
                
                <p>Vào thế kỷ 17, nhà toán học người Pháp Blaise Pascal đã phát minh ra "Pascaline", <strong>máy tính cơ học</strong> đầu tiên có thể thực hiện các phép tính cộng và trừ. Tiếp theo, Gottfried Wilhelm Leibniz đã cải tiến <strong>máy tính</strong> của Pascal bằng cách thêm khả năng nhân và chia. Những phát minh này đặt nền móng cho sự phát triển của <strong>máy tính cơ học</strong> trong suốt thế kỷ 18 và 19.</p>
                
                <p>Đầu thế kỷ 20, Charles Babbage đã thiết kế "Difference Engine", một <strong>máy tính cơ học</strong> có thể tính toán các hàm toán học phức tạp. Ông cũng là người đưa ra ý tưởng về "Analytical Engine", một cỗ máy có thể được lập trình để thực hiện các phép tính khác nhau, được coi là tiền thân của <strong>máy tính hiện đại</strong>.</p>
                
                <p>Thập niên 1940 đánh dấu sự ra đời của <strong>máy tính điện tử</strong> đầu tiên - ENIAC (Electronic Numerical Integrator and Computer). Chiếc máy khổng lồ này nặng khoảng 30 tấn, tiêu thụ điện năng tương đương với một thị trấn nhỏ, nhưng nó đã mở ra kỷ nguyên mới của công nghệ tính toán.</p>
                
                <p>Từ những năm 1970, với sự ra đời của vi xử lý, <strong>máy tính cá nhân</strong> bắt đầu xuất hiện và dần trở nên phổ biến. Các công ty như Apple, IBM, và Microsoft đã đóng vai trò quan trọng trong việc đưa <strong>máy tính</strong> đến với mọi người dùng. Và ngày nay, với sự phát triển của internet, <strong>máy tính online</strong> đã trở thành một công cụ không thể thiếu trong cuộc sống hàng ngày.</p>
                
                <h3>Tầm Quan Trọng Của Máy Tính Trong Cuộc Sống Hiện Đại</h3>
                <p><strong>Máy tính</strong> đã trở thành một phần không thể thiếu trong cuộc sống hiện đại, ảnh hưởng đến hầu hết mọi khía cạnh từ giáo dục, kinh doanh, khoa học đến giải trí. Trong giáo dục, <strong>máy tính</strong> giúp sinh viên và học sinh thực hiện các phép tính phức tạp, trực quan hóa các khái niệm toán học, và thực hiện các dự án nghiên cứu. Các giáo viên cũng sử dụng <strong>máy tính</strong> để tạo ra bài giảng tương tác và đánh giá kết quả học tập của học sinh.</p>
                
                <p>Trong kinh doanh, <strong>máy tính</strong> là công cụ thiết yếu cho việc quản lý tài chính, dự báo doanh thu, tính toán lợi nhuận, và phân tích dữ liệu. Các doanh nghiệp từ nhỏ đến lớn đều dựa vào <strong>máy tính</strong> để vận hành hiệu quả, từ việc quản lý kho hàng đến tối ưu hóa chuỗi cung ứng.</p>
                
                <p>Trong lĩnh vực khoa học và kỹ thuật, <strong>máy tính</strong> đóng vai trò trung tâm trong việc mô phỏng các hiện tượng tự nhiên, thiết kế các sản phẩm mới, và phân tích dữ liệu thí nghiệm. Các nhà khoa học sử dụng <strong>máy tính</strong> để giải các phương trình phức tạp, mô hình hóa hệ thống khí hậu, và thậm chí là khám phá vũ trụ.</p>
                
                <p>Trong y tế, <strong>máy tính</strong> giúp các bác sĩ chẩn đoán bệnh, phân tích kết quả xét nghiệm, và lập kế hoạch điều trị. Các thiết bị y tế hiện đại như máy MRI, CT scan đều dựa trên công nghệ tính toán để tạo ra hình ảnh chi tiết bên trong cơ thể con người.</p>
                
                <p>Ngay cả trong cuộc sống hàng ngày, <strong>máy tính</strong> cũng hiện diện trong mọi thứ từ điện thoại thông minh, đồng hồ thông minh đến các thiết bị gia dụng thông minh. Chúng giúp chúng ta quản lý thời gian, theo dõi sức khỏe, giải trí và kết nối với người khác.</p>
                
                <h3>Ưu Điểm Của Máy Tính Online So Với Máy Tính Cứng</h3>
                <p><strong>Máy tính online</strong> tại May-tinh.com mang lại nhiều ưu điểm vượt trội so với <strong>máy tính cứng</strong> truyền thống:</p>
                
                <ul>
                    <li><strong>Tính tiện lợi:</strong> Bạn có thể truy cập <strong>máy tính</strong> của chúng tôi từ bất kỳ đâu, chỉ cần có kết nối internet. Không cần mang theo một thiết bị riêng hay lo lắng về việc hết pin.</li>
                    <li><strong>Không cần cài đặt:</strong> Không cần tải xuống hay cài đặt bất kỳ phần mềm nào. Chỉ cần mở trình duyệt và truy cập trang web là bạn có thể sử dụng ngay.</li>
                    <li><strong>Luôn cập nhật:</strong> <strong>Máy tính online</strong> của chúng tôi luôn được cập nhật với các tính năng mới nhất và sửa lỗi mà bạn không cần làm gì cả.</li>
                    <li><strong>Đa nền tảng:</strong> Hoạt động tốt trên mọi hệ điều hành (Windows, macOS, Linux) và mọi thiết bị (máy tính, điện thoại, máy tính bảng).</li>
                    <li><strong>Tiết kiệm chi phí:</strong> Hoàn toàn <strong>miễn phí</strong>, không cần chi tiền mua <strong>máy tính cứng</strong> hay phần mềm đắt tiền.</li>
                    <li><strong>Tính linh hoạt:</strong> Dễ dàng chuyển đổi giữa các loại <strong>máy tính</strong> khác nhau (cơ bản, khoa học) chỉ với một cú nhấp chuột.</li>
                    <li><strong>Lưu trữ lịch sử:</strong> <strong>Máy tính</strong> của chúng tôi lưu trữ lịch sử tính toán giúp bạn dễ dàng theo dõi và kiểm tra lại các phép tính trước đó.</li>
                    <li><strong>Bảo mật:</strong> Tất cả các phép tính được thực hiện trên trình duyệt của bạn, không có dữ liệu nào được gửi đến máy chủ, đảm bảo tính riêng tư.</li>
                </ul>
                
                <h3>Các Loại Máy Tính Có Sẵn Tại May-tinh.com</h3>
                <p>Tại May-tinh.com, chúng tôi cung cấp nhiều loại <strong>máy tính</strong> khác nhau để đáp ứng mọi nhu cầu tính toán của bạn:</p>
                
                <p><strong>Máy tính cơ bản:</strong> Đây là loại <strong>máy tính</strong> phổ biến nhất, thực hiện các phép tính cơ bản như cộng, trừ, nhân, chia, phần trăm, căn bậc hai. <strong>Máy tính cơ bản</strong> của chúng tôi còn có các chức năng nhớ (M+, M-, MR, MC) giúp bạn lưu trữ và sử dụng lại các kết quả tính toán.</p>
                
                <p><strong>Máy tính khoa học:</strong> Dành cho học sinh, sinh viên và các chuyên gia cần thực hiện các phép tính phức tạp. <strong>Máy tính khoa học</strong> của chúng tôi có các hàm lượng giác (sin, cos, tan), logarit (log, ln), hàm mũ (e^x, 10^x), và các phép toán khác như giai thừa, giá trị tuyệt đối, và các hằng số toán học (π, e).</p>
                
                <p>Ngoài ra, chúng tôi còn cung cấp các loại <strong>máy tính</strong> chuyên dụng khác như:</p>
                
                <ul>
                    <li><strong>Máy tính tài chính:</strong> Tính lãi suất, vay vốn, đầu tư, tiết kiệm, và các công cụ tài chính khác.</li>
                    <li><strong>Máy tính BMI:</strong> Tính chỉ số khối cơ thể, đánh giá tình trạng sức khỏe.</li>
                    <li><strong>Máy tính chuyển đổi đơn vị:</strong> Chuyển đổi giữa các đơn vị đo lường, tiền tệ, nhiệt độ, và nhiều hơn nữa.</li>
                    <li><strong>Máy tính thống kê:</strong> Tính toán các chỉ số thống kê như trung bình, phương sai, độ lệch chuẩn.</li>
                </ul>
                
                <h3>Hướng Dẫn Sử Dụng Máy Tính Online</h3>
                <p>Sử dụng <strong>máy tính online</strong> tại May-tinh.com rất đơn giản và trực quan. Dưới đây là hướng dẫn chi tiết cho từng loại <strong>máy tính</strong>:</p>
                
                <p><strong>Máy tính cơ bản:</strong></p>
                <ol>
                    <li>Mở trình duyệt web và truy cập May-tinh.com.</li>
                    <li>Chọn tab "Cơ Bản" trên <strong>máy tính</strong>.</li>
                    <li>Nhập số và phép toán bằng cách nhấp vào các nút trên màn hình hoặc sử dụng bàn phím.</li>
                    <li>Sử dụng nút "AC" để xóa tất cả, nút "⌫" để xóa ký tự cuối cùng.</li>
                    <li>Nhấn "=" để xem kết quả.</li>
                    <li>Sử dụng các nút nhớ (M+, M-, MR, MC) để lưu trữ và gọi lại các giá trị.</li>
                </ol>
                
                <p><strong>Máy tính khoa học:</strong></p>
                <ol>
                    <li>Mở trình duyệt web và truy cập May-tinh.com.</li>
                    <li>Chọn tab "Khoa Học" trên <strong>máy tính</strong>.</li>
                    <li>Chọn chế độ góc (DEG, RAD) ở trên màn hình.</li>
                    <li>Nhập số và chọn hàm toán học bạn muốn sử dụng (sin, cos, tan, log, v.v.).</li>
                    <li>Nhập giá trị trong ngoặc đơn sau hàm.</li>
                    <li>Sử dụng các hằng số π và e bằng cách nhấp vào nút tương ứng.</li>
                    <li>Nhấn "=" để xem kết quả.</li>
                </ol>
                
                <h3>Mẹo Và Thủ Thuật Sử Dụng Máy Tính Hiệu Quả</h3>
                <p>Để tận dụng tối đa khả năng của <strong>máy tính online</strong> tại May-tinh.com, dưới đây là một số mẹo và thủ thuật hữu ích:</p>
                
                <ul>
                    <li><strong>Sử dụng bàn phím:</strong> Bạn có thể sử dụng bàn phím để nhập số và phép toán nhanh hơn. Các phím số, phép toán (+, -, *, /), và Enter (để tính kết quả) đều được hỗ trợ.</li>
                    <li><strong>Sử dụng ngoặc đơn:</strong> Khi thực hiện các phép tính phức tạp, hãy sử dụng ngoặc đơn để đảm bảo thứ tự ưu tiên của phép tính. Ví dụ: (5 + 3) * 2 = 16.</li>
                    <li><strong>Lưu trữ kết quả:</strong> Sử dụng các nút nhớ (M+, M-, MR, MC) để lưu trữ các kết quả tính toán và sử dụng lại sau này. Điều này đặc biệt hữu ích khi bạn cần sử dụng một giá trị nhiều lần trong các phép tính khác nhau.</li>
                    <li><strong>Kiểm tra lịch sử:</strong> <strong>Máy tính</strong> của chúng tôi hiển thị lịch sử các phép tính gần nhất, giúp bạn dễ dàng theo dõi và kiểm tra lại các phép tính trước đó.</li>
                    <li><strong>Sử dụng hàm khoa học:</strong> Khi sử dụng <strong>máy tính khoa học</strong>, hãy đảm bảo bạn đã chọn đúng đơn vị góc (DEG, RAD) cho các hàm lượng giác. <strong>Máy tính</strong> của chúng tôi mặc định sử dụng độ (DEG).</li>
                    <li><strong>Sử dụng hàm giải tích:</strong> Khi sử dụng <strong>máy tính giải tích</strong>, hãy nhập đúng cú pháp cho các hàm. Ví dụ: ⌊x⌋(5.7) = 5, ⌈x⌉(5.7) = 6, round(5.7) = 6.</li>
                    <li><strong>Sử dụng hằng số:</strong> <strong>Máy tính khoa học</strong> của chúng tôi có các hằng số toán học quan trọng như π (pi) và e (số Euler). Bạn có thể sử dụng chúng bằng cách nhấp vào nút tương ứng.</li>
                    <li><strong>Tính toán lũy thừa:</strong> Để tính lũy thừa, bạn có thể sử dụng nút "^" trên <strong>máy tính khoa học</strong>. Ví dụ: 2^3 = 8.</li>
                </ul>
                
                <h3>Ứng Dụng Thực Tế Của Máy Tính Trong Đời Sống</h3>
                <p><strong>Máy tính</strong> không chỉ là một công cụ học thuật mà còn có nhiều ứng dụng thực tế trong đời sống hàng ngày. Dưới đây là một số ví dụ về cách bạn có thể sử dụng <strong>máy tính online</strong> của chúng tôi trong các tình huống thực tế:</p>
                
                <p><strong>Quản lý tài chính cá nhân:</strong> Sử dụng <strong>máy tính cơ bản</strong> để tính toán thu nhập, chi tiêu, và tiết kiệm hàng tháng. Bạn cũng có thể sử dụng <strong>máy tính tài chính</strong> để tính lãi suất khi vay tiền hoặc đầu tư.</p>
                
                <p><strong>Nấu ăn và làm bánh:</strong> Khi cần điều chỉnh công thức cho số người khác nhau, <strong>máy tính</strong> giúp bạn tính toán chính xác lượng nguyên liệu cần thiết. Ví dụ: nếu công thức cho 4 người nhưng bạn cần nấu cho 6 người, hãy sử dụng <strong>máy tính</strong> để tính tỷ lệ 6/4 = 1.5 và nhân tất cả nguyên liệu với 1.5.</p>
                
                <p><strong>Tu sửa nhà cửa:</strong> Khi cần tính toán lượng vật liệu như sơn, gạch, hoặc gỗ, <strong>máy tính</strong> giúp bạn ước tính chính xác số lượng cần mua, tránh lãng phí hoặc thiếu hụt.</p>
                
                <p><strong>Lập kế hoạch du lịch:</strong> Sử dụng <strong>máy tính</strong> để tính toán ngân sách du lịch, chuyển đổi tiền tệ, hoặc tính khoảng cách và thời gian di chuyển.</p>
                
                <p><strong>Giáo dục và học tập:</strong> Học sinh và sinh viên có thể sử dụng <strong>máy tính khoa học</strong> để giải các bài toán phức tạp, kiểm tra kết quả, và hiểu rõ hơn về các khái niệm toán học. <strong>Máy tính cho học sinh</strong> là công cụ không thể thiếu trong quá trình học tập.</p>
                
                <p><strong>Công việc và kinh doanh:</strong> Các chuyên gia sử dụng <strong>máy tính</strong> để tính toán tỷ suất lợi nhuận, phân tích dữ liệu bán hàng, và lập kế hoạch tài chính.</p>
                
                <p><strong>Sức khỏe và thể hình:</strong> Sử dụng <strong>máy tính BMI</strong> để theo dõi chỉ số khối cơ thể, hoặc tính toán lượng calo tiêu thụ khi tập luyện.</p>
                
                <h3>Tương Lai Của Máy Tính Online</h3>
                <p>Công nghệ <strong>máy tính</strong> đang phát triển không ngừng và <strong>máy tính online</strong> cũng không ngoại lệ. Trong tương lai, chúng ta có thể kỳ vọng những cải tiến sau đây:</p>
                
                <ul>
                    <li><strong>Trí tuệ nhân tạo (AI):</strong> <strong>Máy tính</strong> sẽ tích hợp AI để hiểu và giải quyết các vấn đề phức tạp hơn, thậm chí có thể gợi ý các phương pháp tính toán tối ưu.</li>
                    <li><strong>Giao diện giọng nói:</strong> Người dùng có thể thực hiện các phép tính bằng giọng nói tự nhiên, giúp việc sử dụng <strong>máy tính</strong> trở nên tiện lợi hơn.</li>
                    <li><strong>Thực tế tăng cường (AR):</strong> <strong>Máy tính</strong> có thể được tích hợp vào môi trường thực tế thông qua AR, cho phép người dùng thực hiện các phép tính trực tiếp trên các vật thể trong thế giới thực.</li>
                    <li><strong>Tích hợp với các thiết bị IoT:</strong> <strong>Máy tính</strong> sẽ kết nối với các thiết bị thông minh khác trong nhà và nơi làm việc, tự động thực hiện các phép toán cần thiết.</li>
                    <li><strong>Cá nhân hóa:</strong> <strong>Máy tính</strong> sẽ học thói quen sử dụng của từng người dùng và tùy chỉnh giao diện, chức năng để phù hợp nhất với nhu cầu cá nhân.</li>
                    <li><strong>Tính toán đám mây nâng cao:</strong> Các phép tính phức tạp sẽ được thực hiện trên đám mây, cho phép <strong>máy tính online</strong> xử lý các tác vụ nặng mà không làm chậm thiết bị của người dùng.</li>
                </ul>
                
                <h3>Kết Luận</h3>
                <p><strong>Máy tính online</strong> tại May-tinh.com không chỉ là một công cụ tính toán đơn thuần mà còn là một giải pháp toàn diện cho mọi nhu cầu tính toán của bạn. Với giao diện thân thiện, tính năng đa dạng, và khả năng truy cập từ mọi thiết bị, <strong>máy tính</strong> của chúng tôi là lựa chọn lý tưởng cho học sinh, sinh viên, chuyên gia và mọi người dùng.</p>
                
                <p>Chúng tôi cam kết liên tục cải tiến và phát triển sản phẩm để mang đến trải nghiệm tốt nhất cho người dùng. Hãy truy cập May-tinh.com ngay hôm nay để khám phá sức mạnh của <strong>máy tính online</strong> và trải nghiệm sự tiện lợi mà nó mang lại!</p>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section" id="features">
        <div class="container">
            <div class="section-title">
                <h2>Tính Năng Nổi Bật Của Máy Tính Online</h2>
                <p><strong>Máy tính online</strong> của chúng tôi có nhiều tính năng hữu ích cho mọi nhu cầu</p>
            </div>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h3>Dễ Sử Dụng</h3>
                    <p>Giao diện <strong>máy tính</strong> đơn giản, trực quan, phù hợp với mọi đối tượng người dùng</p>
                    <a href="#">Tìm hiểu thêm <i class="fas fa-arrow-right"></i></a>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <h3>Tương Thích Đa Thiết Bị</h3>
                    <p><strong>Máy tính</strong> hoạt động tốt trên máy tính, điện thoại và máy tính bảng</p>
                    <a href="#">Tìm hiểu thêm <i class="fas fa-arrow-right"></i></a>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <h3>Nhanh Chóng</h3>
                    <p><strong>Máy tính</strong> tính toán tức thì, không cần chờ đợi, tiết kiệm thời gian</p>
                    <a href="#">Tìm hiểu thêm <i class="fas fa-arrow-right"></i></a>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>Bảo Mật</h3>
                    <p>Toàn bộ dữ liệu <strong>máy tính</strong> được xử lý tại trình duyệt, không lưu trữ thông tin</p>
                    <a href="#">Tìm hiểu thêm <i class="fas fa-arrow-right"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- Ad Section 2 - For AdSense Auto Ads -->
    <section class="ad-section">
        <div class="container">
            <!-- AdSense will automatically place ads here -->
        </div>
    </section>

    <!-- Future Features Section -->
    <section class="future-features-section" id="future">
        <div class="container">
            <div class="section-title">
                <h2>Tính Năng Tương Lai Của Máy Tính Online</h2>
                <p>Khám phá các tính năng đột phá sẽ được cập nhật trong tương lai</p>
            </div>
            
            <div class="future-features-grid">
                <div class="future-feature-card">
                    <div class="future-feature-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h3>Trí Tuệ Nhân Tạo (AI)</h3>
                    <p><strong>Máy tính</strong> sẽ tích hợp AI để hiểu và giải quyết các vấn đề phức tạp hơn, thậm chí có thể gợi ý các phương pháp tính toán tối ưu dựa trên ngữ cảnh và lịch sử sử dụng của người dùng.</p>
                    <a href="#">Tìm hiểu thêm <i class="fas fa-arrow-right"></i></a>
                </div>
                
                <div class="future-feature-card">
                    <div class="future-feature-icon">
                        <i class="fas fa-microphone-alt"></i>
                    </div>
                    <h3>Giao Diện Giọng Nói</h3>
                    <p>Người dùng có thể thực hiện các phép tính bằng giọng nói tự nhiên, giúp việc sử dụng <strong>máy tính</strong> trở nên tiện lợi hơn, đặc biệt khi tay đang bận hoặc khi sử dụng trên thiết bị di động.</p>
                    <a href="#">Tìm hiểu thêm <i class="fas fa-arrow-right"></i></a>
                </div>
                
                <div class="future-feature-card">
                    <div class="future-feature-icon">
                        <i class="fas fa-vr-cardboard"></i>
                    </div>
                    <h3>Thực Tế Tăng Cường (AR)</h3>
                    <p><strong>Máy tính</strong> sẽ được tích hợp vào môi trường thực tế thông qua AR, cho phép người dùng thực hiện các phép tính trực tiếp trên các vật thể trong thế giới thực thông qua camera điện thoại.</p>
                    <a href="#">Tìm hiểu thêm <i class="fas fa-arrow-right"></i></a>
                </div>
                
                <div class="future-feature-card">
                    <div class="future-feature-icon">
                        <i class="fas fa-network-wired"></i>
                    </div>
                    <h3>Tích Hợp IoT</h3>
                    <p><strong>Máy tính</strong> sẽ kết nối với các thiết bị thông minh khác trong nhà và nơi làm việc, tự động thực hiện các phép toán cần thiết và hiển thị kết quả trên các thiết bị được kết nối.</p>
                    <a href="#">Tìm hiểu thêm <i class="fas fa-arrow-right"></i></a>
                </div>
                
                <div class="future-feature-card">
                    <div class="future-feature-icon">
                        <i class="fas fa-user-cog"></i>
                    </div>
                    <h3>Cá Nhân Hóa</h3>
                    <p><strong>Máy tính</strong> sẽ học thói quen sử dụng của từng người dùng và tùy chỉnh giao diện, chức năng để phù hợp nhất với nhu cầu cá nhân, tạo ra trải nghiệm tính toán độc đáo cho mỗi người.</p>
                    <a href="#">Tìm hiểu thêm <i class="fas fa-arrow-right"></i></a>
                </div>
                
                <div class="future-feature-card">
                    <div class="future-feature-icon">
                        <i class="fas fa-cloud"></i>
                    </div>
                    <h3>Tính Toán Đám Mây Nâng Cao</h3>
                    <p>Các phép tính phức tạp sẽ được thực hiện trên đám mây, cho phép <strong>máy tính online</strong> xử lý các tác vụ nặng mà không làm chậm thiết bị của người dùng, đồng thời cung cấp kết quả nhanh hơn.</p>
                    <a href="#">Tìm hiểu thêm <i class="fas fa-arrow-right"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- Calculators Section -->
    <section class="calculators-section">
        <div class="container">
            <div class="section-title">
                <h2>Các Loại Máy Tính Khác</h2>
                <p>Chúng tôi cung cấp nhiều loại <strong>máy tính</strong> chuyên dụng cho mọi nhu cầu</p>
            </div>
            
            <div class="calculators-grid">
                <div class="calculator-card">
                    <div class="calculator-card-img">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="calculator-card-body">
                        <h3>Máy Tính Tài Chính</h3>
                        <p>Tính lãi suất, vay vốn, đầu tư, tiết kiệm và các công cụ tài chính khác</p>
                        <a href="#">Sử dụng <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
                
                <div class="calculator-card">
                    <div class="calculator-card-img">
                        <i class="fas fa-weight"></i>
                    </div>
                    <div class="calculator-card-body">
                        <h3>Máy Tính BMI</h3>
                        <p>Tính chỉ số khối cơ thể, đánh giá tình trạng sức khỏe</p>
                        <a href="#">Sử dụng <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
                
                <div class="calculator-card">
                    <div class="calculator-card-img">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <div class="calculator-card-body">
                        <h3>Máy Tính Chuyển Đổi</h3>
                        <p>Chuyển đổi đơn vị đo lường, tiền tệ, nhiệt độ và nhiều hơn nữa</p>
                        <a href="#">Sử dụng <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
                
                <div class="calculator-card">
                    <div class="calculator-card-img">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="calculator-card-body">
                        <h3>Máy Tính Thống Kê</h3>
                        <p>Tính toán các chỉ số thống kê như trung bình, phương sai, độ lệch chuẩn</p>
                        <a href="#">Sử dụng <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Blog Section -->
    <section class="blog-section" id="blog">
        <div class="container">
            <div class="section-title">
                <h2>Blog Máy Tính</h2>
                <p>Các bài viết hữu ích về <strong>máy tính</strong> và toán học</p>
            </div>
            
            <div class="blog-grid">
                <div class="blog-card">
                    <div class="blog-img">
                        Hình ảnh bài viết 1
                    </div>
                    <div class="blog-body">
                        <div class="blog-date">15/10/2023</div>
                        <h3 class="blog-title">Lịch Sử Phát Triển Của Máy Tính</h3>
                        <p class="blog-excerpt">Khám phá hành trình phát triển ấn tượng của <strong>máy tính</strong> từ những công cụ cơ bản nhất đến các siêu <strong>máy tính điện tử</strong> hiện đại...</p>
                        <a href="#" class="blog-link">Đọc thêm <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
                
                <div class="blog-card">
                    <div class="blog-img">
                        Hình ảnh bài viết 2
                    </div>
                    <div class="blog-body">
                        <div class="blog-date">10/10/2023</div>
                        <h3 class="blog-title">Cách Sử Dụng Máy Tính Khoa Học Hiệu Quả</h3>
                        <p class="blog-excerpt">Hướng dẫn chi tiết cách sử dụng các hàm trên <strong>máy tính khoa học</strong> để giải quyết các bài toán phức tạp...</p>
                        <a href="#" class="blog-link">Đọc thêm <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
                
                <div class="blog-card">
                    <div class="blog-img">
                        Hình ảnh bài viết 3
                    </div>
                    <div class="blog-body">
                        <div class="blog-date">05/10/2023</div>
                        <h3 class="blog-title">Ứng Dụng Của Máy Tính Trong Cuộc Sống Hàng Ngày</h3>
                        <p class="blog-excerpt">Tìm hiểu cách <strong>máy tính</strong> giúp chúng ta giải quyết các vấn đề thực tế trong công việc, học tập và cuộc sống...</p>
                        <a href="#" class="blog-link">Đọc thêm <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Ad Section 3 - For AdSense Auto Ads -->
    <section class="ad-section">
        <div class="container">
            <!-- AdSense will automatically place ads here -->
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="faq-section" id="faq">
        <div class="container">
            <div class="section-title">
                <h2>Câu Hỏi Thường Gặp Về Máy Tính</h2>
                <p>Giải đáp các thắc mắc về <strong>máy tính online</strong> của chúng tôi</p>
            </div>
            
            <div class="accordion" id="faqAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                            <strong>Máy tính online</strong> có miễn phí không?
                        </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Có, <strong>máy tính online</strong> tại May-tinh.com hoàn toàn miễn phí. Bạn không cần trả bất kỳ khoản phí nào để sử dụng tất cả các tính năng của <strong>máy tính</strong> của chúng tôi.
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            Tôi có thể sử dụng <strong>máy tính</strong> trên điện thoại không?
                        </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Có, <strong>máy tính</strong> của chúng tôi được thiết kế để hoạt động tốt trên mọi thiết bị, bao gồm cả điện thoại thông minh và máy tính bảng. Giao diện sẽ tự động điều chỉnh để phù hợp với kích thước màn hình của bạn.
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                            <strong>Máy tính</strong> có lưu trữ dữ liệu của tôi không?
                        </button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Không, <strong>máy tính</strong> của chúng tôi không lưu trữ bất kỳ dữ liệu nào của bạn. Tất cả các phép tính được thực hiện trực tiếp trên trình duyệt của bạn và không được gửi đến máy chủ của chúng tôi.
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingFour">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                            Làm thế nào để chuyển giữa các loại <strong>máy tính</strong> khác nhau?
                        </button>
                    </h2>
                    <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Bạn có thể dễ dàng chuyển đổi giữa các loại <strong>máy tính</strong> bằng cách nhấp vào các tab ở trên cùng của <strong>máy tính</strong>: "Cơ Bản", "Khoa Học". Mỗi tab sẽ hiển thị các chức năng tương ứng với loại <strong>máy tính</strong> đó.
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingFive">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                            Tôi có thể sử dụng bàn phím để nhập số không?
                        </button>
                    </h2>
                    <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Có, bạn có thể sử dụng bàn phím để nhập số và các phép toán cơ bản. Các phím số, phép toán (+, -, *, /), và Enter (để tính kết quả) đều được hỗ trợ. Tuy nhiên, một số hàm đặc biệt có thể cần sử dụng chuột.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section class="about-section" id="about">
        <div class="container">
            <div class="section-title">
                <h2>Về Chúng Tôi - May-tinh.com</h2>
                <p>Giới thiệu về nền tảng <strong>máy tính online</strong> hàng đầu Việt Nam</p>
            </div>
            
            <div class="about-content">
                <div class="about-text">
                    <h3>May-tinh.com - Nền Tảng Máy Tính Online Hàng Đầu Việt Nam</h3>
                    <p>May-tinh.com được thành lập với sứ mệnh mang đến cho người Việt Nam một công cụ <strong>máy tính</strong> trực tuyến miễn phí, chính xác và dễ sử dụng. Chúng tôi hiểu rằng trong cuộc sống hiện đại, việc có một <strong>máy tính</strong> đáng tin cậy là rất quan trọng cho công việc, học tập và cuộc sống hàng ngày.</p>
                    
                    <p>Đội ngũ của chúng tôi bao gồm các chuyên gia công nghệ, toán học và thiết kế giao diện người dùng, cùng làm việc để tạo ra một sản phẩm không chỉ chức năng mà còn thân thiện với người dùng. Chúng tôi liên tục cập nhật và cải tiến sản phẩm để đáp ứng nhu cầu ngày càng cao của người dùng.</p>
                    
                    <p>Ngoài <strong>máy tính cơ bản</strong>, chúng tôi còn phát triển các loại <strong>máy tính</strong> chuyên dụng như <strong>máy tính khoa học</strong>, <strong>máy tính tài chính</strong>, <strong>máy tính BMI</strong>, và nhiều công cụ khác để phục vụ mọi nhu cầu tính toán của bạn.</p>
                    
                    <p>Chúng tôi cam kết cung cấp dịch vụ <strong>miễn phí</strong> và không bao giờ thu thập thông tin cá nhân của người dùng. Tất cả các phép tính được thực hiện trực tiếp trên trình duyệt của bạn, đảm bảo tính riêng tư và bảo mật.</p>
                </div>
                
                <div class="about-img">
                    Hình ảnh về chúng tôi
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Về Máy Tính</h3>
                    <p>May-tinh.com cung cấp các công cụ <strong>máy tính</strong> trực tuyến miễn phí, chính xác và dễ sử dụng cho mọi người Việt Nam.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Liên Kết Nhanh</h3>
                    <ul class="footer-links">
                        <li><a href="#home">Trang Chủ</a></li>
                        <li><a href="#calculators">Máy Tính</a></li>
                        <li><a href="#features">Tính Năng</a></li>
                        <li><a href="#future">Tính Năng Tương Lai</a></li>
                        <li><a href="#blog">Blog</a></li>
                        <li><a href="#faq">FAQ</a></li>
                        <li><a href="#about">Về Chúng Tôi</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Loại Máy Tính</h3>
                    <ul class="footer-links">
                        <li><a href="#">Máy Tính Cơ Bản</a></li>
                        <li><a href="#">Máy Tính Khoa Học</a></li>
                        <li><a href="#">Máy Tính Tài Chính</a></li>
                        <li><a href="#">Máy Tính BMI</a></li>
                        <li><a href="#">Máy Tính Chuyển Đổi</a></li>
                        <li><a href="#">Máy Tính Thống Kê</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Liên Hệ</h3>
                    <ul class="footer-links">
                        <li><i class="fas fa-map-marker-alt"></i> Hà Nội, Việt Nam</li>
                        <li><i class="fas fa-phone"></i> +84 123 456 789</li>
                        <li><i class="fas fa-envelope"></i> info@may-tinh.com</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2023 May-tinh.com. Tất cả quyền được bảo lưu.</p>
            </div>
        </div>
    </footer>

    <!-- Modal moved outside calculator section -->
    <div class="modal-overlay" id="historyModal" role="dialog" aria-modal="true" aria-labelledby="historyTitle">
        <div class="modal">
            <h2 id="historyTitle">Lịch sử tính toán</h2>
            <div id="historyContent" tabindex="0"></div>
            <button class="close-btn" onclick="closeHistory()" aria-label="Đóng lịch sử">×</button>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Mobile Menu JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            
            mobileMenuBtn.addEventListener('click', function() {
                mobileMenu.classList.toggle('active');
                
                // Change icon between bars and times
                const icon = mobileMenuBtn.querySelector('i');
                if (icon.classList.contains('fa-bars')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            // Close mobile menu when clicking on a link
            const mobileLinks = document.querySelectorAll('.mobile-menu-links a');
            mobileLinks.forEach(link => {
                link.addEventListener('click', function() {
                    mobileMenu.classList.remove('active');
                    const icon = mobileMenuBtn.querySelector('i');
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                });
            });
        });
    </script>
    
    <!-- Calculator JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/mathjs@11.9.1/lib/browser/math.js"></script>
    <script>
      const display = document.getElementById('display');
  const expression = document.getElementById('expression');
  const historyBtn = document.getElementById('historyBtn');
  const historyModal = document.getElementById('historyModal');
  const historyContent = document.getElementById('historyContent');
  const basicBtn = document.getElementById('basicBtn');
  const sciBtn = document.getElementById('sciBtn');
  const basicButtons = document.getElementById('basicButtons');
  const sciButtons = document.getElementById('sciButtons');
  const angleRadios = document.querySelectorAll('input[name="angleMode"]');
  const acBackspaceBtn = document.getElementById('acBackspaceBtn');

  let angleMode = 'deg';
  let history = [];
  let isResult = false;
  let lastOperator = null;
  let savedSelection = null; // To save cursor position
  let isACMode = true; // Track if the button should show AC or Backspace
  let currentMode = 'basic'; // Track current mode
  let insideFunction = false; // Track if cursor is inside a function

  basicBtn.onclick = () => toggleMode('basic');
  sciBtn.onclick = () => toggleMode('scientific');
  historyBtn.onclick = openHistory;

  // Initialize the calculator based on screen size
  function initializeCalculator() {
    if (window.innerWidth <= 768) {
      // Mobile view
      currentMode = 'basic';
      basicButtons.style.display = 'grid';
      sciButtons.style.display = 'none';
      basicBtn.classList.add('active');
      sciBtn.classList.remove('active');
    } else {
      // Desktop view - both button sets should be visible
      basicButtons.style.display = 'grid';
      sciButtons.style.display = 'grid';
      basicBtn.classList.remove('active');
      sciBtn.classList.remove('active');
    }
  }

  // Handle window resize
  window.addEventListener('resize', initializeCalculator);

  function toggleMode(mode) {
    // Only apply mode toggle in mobile view
    if (window.innerWidth <= 768) {
      currentMode = mode;
      if (mode === 'basic') {
        basicButtons.style.display = 'grid';
        sciButtons.style.display = 'none';
        basicBtn.classList.add('active');
        sciBtn.classList.remove('active');
      } else {
        basicButtons.style.display = 'none';
        sciButtons.style.display = 'grid';
        basicBtn.classList.remove('active');
        sciBtn.classList.add('active');
      }
    }
    focusDisplay();
  }

  function focusDisplay() {
    display.focus();
  }

  function saveCursorPosition() {
    const sel = window.getSelection();
    if (sel.rangeCount > 0) {
      savedSelection = sel.getRangeAt(0);
    }
  }

  function restoreCursorPosition() {
    if (savedSelection) {
      const sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(savedSelection);
    }
  }

  function placeCaretAtEnd(el) {
    el.focus();
    if (typeof window.getSelection !== "undefined" &&
        typeof document.createRange !== "undefined") {
      let range = document.createRange();
      range.selectNodeContents(el);
      range.collapse(false);
      let sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
      // Save this position
      savedSelection = range;
    }
  }

  function placeCaretAt(node) {
    focusDisplay();
    if (typeof window.getSelection !== "undefined" &&
        typeof document.createRange !== "undefined") {
      let range = document.createRange();
      range.selectNodeContents(node);
      range.collapse(false);
      let sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
      // Save this position
      savedSelection = range;
    }
  }

  function placeCaretAtBeginning(node) {
    focusDisplay();
    if (typeof window.getSelection !== "undefined" &&
        typeof document.createRange !== "undefined") {
      let range = document.createRange();
      range.selectNodeContents(node);
      range.collapse(true);
      let sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
      // Save this position
      savedSelection = range;
    }
  }

  function updateACBackspaceButton() {
    if (isACMode) {
      acBackspaceBtn.textContent = 'AC';
    } else {
      acBackspaceBtn.textContent = '⌫';
    }
  }

  function toggleACBackspace() {
    if (isACMode) {
      clearAll();
    } else {
      backspace();
    }
  }

  function insertChar(char) {
    // If we're starting a new operation after a result with a digit, clear the display
    if (isResult && !isNaN(char)) {
      display.innerHTML = '';
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
    }
    
    // Change AC to Backspace when user starts typing a digit
    if (isACMode && !isNaN(char) && display.innerText.trim() !== '0') {
      isACMode = false;
      updateACBackspaceButton();
    }
    
    // Handle operator replacement
    if (['+', '-', '*', '/'].includes(char)) {
      // If we're starting a new operation after a result, keep the result
      if (isResult) {
        isResult = false;
      }
      
      // Get the plain text content
      const text = getPlainExpression(display).trim();
      const lastChar = text.length > 0 ? text.charAt(text.length - 1) : '';
      
      // For non-minus operators, replace any existing operator at the end
      if (char !== '-') {
        if (['+', '-', '×', '÷'].includes(lastChar)) {
          // Remove the last operator
          placeCaretAtEnd(display);
          backspace();
        }
      } else {
        // For minus operator, special handling
        if (['+', '×', '÷'].includes(lastChar)) {
          // Allow minus after other operators (for negative numbers)
          // Just insert the minus
        } else if (lastChar === '-') {
          // If last character is already a minus, replace it
          placeCaretAtEnd(display);
          backspace();
        }
      }
      
      // Remember the current operator for next time
      lastOperator = char;
      
      // Convert to display symbols
      if (char === '/') char = '÷';
      if (char === '*') char = '×';
      
      // Insert the operator
      insertTextAtCursor(char);
      focusDisplay();
      return;
    }
    
    if (char === '.') {
      let text = getPlainExpression(display);
      const sel = window.getSelection();
      let range = sel.rangeCount ? sel.getRangeAt(0) : null;
      let pos = range ? range.startOffset : text.length;
      let before = text.substr(0, pos);
      let after = text.substr(pos);

      let lastGroup = before.match(/(\d*\.\d*|\d+)$/);
      if (lastGroup && lastGroup[0].includes('.')) return;
      if (after.match(/^\d*\./)) return;
    }
    if (char === '/') char = '÷';
    if (display.innerText.trim() === '0') display.innerHTML = '';
    if (char === '*') char = '×';
    insertTextAtCursor(char);
    focusDisplay();
  }

  function insertTextAtCursor(text) {
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    const range = sel.getRangeAt(0);
    
    // --- Start of Corrected Logic for Exponent Box ---
    let container = range.startContainer;
    let expBox = null;

    // Check if the cursor is inside an exponent box, whether it's empty or not.
    if (container.nodeType === Node.ELEMENT_NODE && container.classList.contains('exp')) {
      // Case 1: Cursor is in an empty exponent box.
      expBox = container;
    } else if (container.nodeType === Node.TEXT_NODE && container.parentNode.classList.contains('exp')) {
      // Case 2: Cursor is in a text node that's inside an exponent box.
      expBox = container.parentNode;
    }

    if (expBox) {
      // If we are inside an exponent box, handle it here.
      if (!expBox.classList.contains('typed')) {
        // If it's the first character, add the 'typed' class to remove the box visuals.
        expBox.classList.add('typed');
      }
      
      // Use standard insertion logic which works correctly.
      range.deleteContents();
      const textNode = document.createTextNode(text);
      range.insertNode(textNode);
      // Move cursor after the newly inserted character.
      range.setStart(textNode, text.length);
      range.collapse(true);
      sel.removeAllRanges();
      sel.addRange(range);
      savedSelection = range;
      return; // Exit the function since we've handled the insertion.
    }
    // --- End of Corrected Logic ---
    
    // This is the original logic for all other cases (not in an exponent box).
    range.deleteContents();
    const textNode = document.createTextNode(text);
    range.insertNode(textNode);
    range.setStart(textNode, text.length);
    range.collapse(true);
    sel.removeAllRanges();
    sel.addRange(range);
    // Save this position
    savedSelection = range;
  }
  function backspace() {
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    const range = sel.getRangeAt(0);

    if (!range.collapsed) {
      range.deleteContents();
      // Save this position
      savedSelection = range;
      // Check if we should switch to AC mode
      checkIfInsideFunction();
      return;
    }

    let node = range.startContainer;
    let offset = range.startOffset;

    // Handle backspace in power expressions
    if (node.classList && node.classList.contains('exp')) {
      if (node.textContent.length <= 1) {
        // If exponent has one character or is empty, move cursor to base
        const powerExpr = node.closest('.power-expr, .exp-x-expr');
        if (powerExpr) {
          // If the exponent box is empty, remove the entire function
          if (node.textContent.trim() === '') {
            powerExpr.remove();
            placeCaretAtEnd(display);
            // Switch back to AC mode
            isACMode = true;
            updateACBackspaceButton();
            return;
          }
          
          const baseNode = powerExpr.querySelector('.base');
          placeCaretAtEnd(baseNode);
          // Check if we should switch to AC mode
          checkIfInsideFunction();
          return;
        }
      } else {
        // Remove last character from exponent
        const currentText = node.textContent;
        node.textContent = currentText.slice(0, -1);
        // Move cursor to end
        range.selectNodeContents(node);
        range.collapse(false);
        sel.removeAllRanges();
        sel.addRange(range);
        
        // CRITICAL FIX: Check if the exponent box is now empty after removing the character
        if (node.textContent.trim() === '') {
          // Switch to AC mode if the exponent box is empty
          isACMode = true;
          updateACBackspaceButton();
        } else {
          // Otherwise, check if we're inside a function
          checkIfInsideFunction();
        }
        return;
      }
    }

    // Handle backspace after calculation (when display contains plain text)
    if (node.nodeType === Node.TEXT_NODE && node.parentNode === display) {
      if (offset > 0) {
        node.textContent = node.textContent.slice(0, offset - 1) + node.textContent.slice(offset);
        setCaretPosition(node, offset - 1);
      } else if (node.previousSibling) {
        let prev = node.previousSibling;
        if (prev.nodeType === Node.TEXT_NODE) {
          let len = prev.textContent.length;
          prev.textContent = prev.textContent.slice(0, -1);
          setCaretPosition(prev, Math.max(0, len - 1));
        } else {
          prev.remove();
        }
      }
    } else if (node.nodeType === Node.TEXT_NODE) {
      if (offset > 0) {
        node.textContent = node.textContent.slice(0, offset - 1) + node.textContent.slice(offset);
        setCaretPosition(node, offset - 1);
        
        // CRITICAL FIX: If we just cleared the exponent text, check if it's empty
        let expNode = node;
        if (node.parentNode && node.parentNode.classList.contains('exp')) {
          expNode = node.parentNode;
          if (expNode.textContent === '') {
            expNode.classList.remove('typed');
            // Switch to AC mode if the exponent box is empty
            isACMode = true;
            updateACBackspaceButton();
          }
        }
      } else {
        if (node.previousSibling) {
          let prev = node.previousSibling;
          if (prev.nodeType === Node.TEXT_NODE) {
            let len = prev.textContent.length;
            prev.textContent = prev.textContent.slice(0, -1);
            setCaretPosition(prev, Math.max(0, len - 1));
          } else {
            prev.remove();
          }
        }
      }
    } else if (node.nodeType === Node.ELEMENT_NODE && node !== display) {
      // If we're at the beginning of an element, remove the element
      if (offset === 0 && node.previousSibling) {
        node.previousSibling.remove();
        placeCaretAtEnd(display);
      }
    }

    // Check if display is empty after backspace and reset to 0 if needed
    if (display.innerText.trim() === '') {
      display.innerHTML = '0';
      placeCaretAtEnd(display);
      // Switch back to AC mode
      isACMode = true;
      updateACBackspaceButton();
    } else {
      // Check if we're inside a function
      checkIfInsideFunction();
    }
  }

  // Function to check if cursor is inside a function
  function checkIfInsideFunction() {
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    
    const range = sel.getRangeAt(0);
    let node = range.startContainer;
    
    // Check if cursor is inside an exponent box of e^x or x^y
    if (node.classList && node.classList.contains('exp')) {
      const expXExpr = node.closest('.exp-x-expr, .power-expr');
      if (expXExpr) {
        // If the exponent box is empty, we're inside a function
        if (node.textContent.trim() === '') {
          isACMode = true;
                    updateACBackspaceButton();
          return;
        }
      }
    }
    
    // CRITICAL FIX: Also check if cursor is in a text node inside an exponent box
    if (node.nodeType === Node.TEXT_NODE && node.parentNode && node.parentNode.classList.contains('exp')) {
      const expNode = node.parentNode;
      const expXExpr = expNode.closest('.exp-x-expr, .power-expr');
      if (expXExpr) {
        // If the exponent box is empty, we're inside a function
        if (expNode.textContent.trim() === '') {
          isACMode = true;
          updateACBackspaceButton();
          return;
        }
      }
    }
    
    // Get the plain text content
    const text = getPlainExpression(display);
    
    // Check if we're inside any function parentheses
    let cursorPos = 0;
    
    // Calculate cursor position in the text
    if (node.nodeType === Node.TEXT_NODE) {
      // Find the position of this text node in the display
      let tempNode = display.firstChild;
      while (tempNode && tempNode !== node) {
        if (tempNode.nodeType === Node.TEXT_NODE) {
          cursorPos += tempNode.textContent.length;
        }
        tempNode = tempNode.nextSibling;
      }
      cursorPos += range.startOffset;
    }
    
    // Check if cursor is inside any function parentheses
    let insideAnyFunction = false;
    let openParenCount = 0;
    
    // List of function patterns to check
    const functionPatterns = [
      'sin⁻¹', 'cos⁻¹', 'tan⁻¹', // 4 characters each
      'sin', 'cos', 'tan', 'log', 'ln', 'abs', // 3 characters each
      '1/', // 2 characters
      '³√', // 2 characters
      '√',  // 1 character
      'e^',  // For e^x
      'x^'   // For x^y
    ];
    
    // Sort by length descending to match longer patterns first
    functionPatterns.sort((a, b) => b.length - a.length);
    
    // Also check for power expressions like ()² and ()³
    const powerPatterns = [')²', ')³'];
    
    // Scan through the text to find function patterns
    for (let i = 0; i < text.length; i++) {
      // Check if any function pattern starts at this position
      let foundFunction = false;
      for (const pattern of functionPatterns) {
        if (text.substr(i, pattern.length) === pattern) {
          // Found a function pattern
          foundFunction = true;
          i += pattern.length - 1; // Skip ahead, but the loop will increment by 1 more
          break;
        }
      }
      
      // Check for power patterns
      let foundPower = false;
      for (const pattern of powerPatterns) {
        if (text.substr(i, pattern.length) === pattern) {
          // Found a power pattern
          foundPower = true;
          i += pattern.length - 1; // Skip ahead, but the loop will increment by 1 more
          break;
        }
      }
      
      if (foundFunction) {
        // The next character should be an opening parenthesis for most functions
        if (i + 1 < text.length && text[i + 1] === '(') {
          openParenCount++;
          i++; // Skip the opening parenthesis
        }
        // Special case for e^x and x^y - they don't have parentheses but are functions
        else if (text.substr(i - 1, 2) === 'e^' || text.substr(i - 1, 2) === 'x^') {
          // These are special function patterns
          openParenCount++;
        }
      } else if (foundPower) {
        // Power patterns like ()² and ()³ are functions
        openParenCount++;
      } else if (text[i] === '(') {
        openParenCount++;
      } else if (text[i] === ')') {
        if (openParenCount > 0) {
          openParenCount--;
        }
      }
      
      // Check if cursor is at this position
      if (i === cursorPos - 1) {
        // If we have any open parentheses, we're inside a function
        insideAnyFunction = openParenCount > 0;
        break;
      }
    }
    
    // Set AC/Backspace mode based on whether we're inside a function
    if (insideAnyFunction) {
      isACMode = true;
      updateACBackspaceButton();
    } else {
      // Check if only one digit remains
      checkIfOnlyOneDigitRemains();
    }
  }

  // New function to check if only one digit remains
  function checkIfOnlyOneDigitRemains() {
    const text = getPlainExpression(display);
    
    // Check if the text is a single digit (0-9) and length is 1
    if (text.length === 1 && /^\d$/.test(text)) {
      // Switch back to AC mode
      isACMode = true;
      updateACBackspaceButton();
    } else {
      // Make sure we're in backspace mode if there's more than one digit
      isACMode = false;
      updateACBackspaceButton();
    }
  }

  function setCaretPosition(node, offset) {
    const sel = window.getSelection();
    const range = document.createRange();
    range.setStart(node, Math.max(0, offset));
    range.collapse(true);
    sel.removeAllRanges();
    sel.addRange(range);
    // Save this position
    savedSelection = range;
  }

  function insertFunction(func) {
    // If we're starting a new operation after a result, clear the display
    if (isResult) {
      display.innerHTML = '';
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
    }
    
    // Clear display if it's just "0"
    if (display.innerText.trim() === '0') {
      display.innerHTML = '';
    }
    
    // Map function names to display names
    const displayNames = {
      'asin': 'sin⁻¹',
      'acos': 'cos⁻¹',
      'atan': 'tan⁻¹'
    };
    
    const displayName = displayNames[func] || func;
    
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    const range = sel.getRangeAt(0);

    if (!range.collapsed) {
      const selected = range.extractContents();
      const span = document.createElement('span');
      span.appendChild(selected);

      const funcNode = document.createTextNode(displayName + "(");
      const closingNode = document.createTextNode(")");
      const frag = document.createDocumentFragment();
      frag.appendChild(funcNode);
      frag.appendChild(span);
      frag.appendChild(closingNode);

      range.insertNode(frag);

      let lastNode = span.lastChild || span;
      placeCaretAtEnd(lastNode);
    } else {
      const funcNode = document.createTextNode(displayName + "(");
      const closingNode = document.createTextNode(")");
      range.insertNode(funcNode);

      range.setStartAfter(funcNode);
      sel.removeAllRanges();
      sel.addRange(range);

      range.insertNode(closingNode);
      range.setStartBefore(closingNode);
      range.collapse(true);
      sel.removeAllRanges();
      sel.addRange(range);
      // Save this position
      savedSelection = range;
    }
    
    // Set AC mode since we're inside a function
    isACMode = true;
    updateACBackspaceButton();
  }

  function insertPower() {
    // If we're starting a new operation after a result, use the result as the base
    if (isResult) {
      const resultText = display.innerText;
      display.innerHTML = '';
      expression.innerHTML = '';
      const powerExpr = createPowerExpr(resultText);
      display.appendChild(powerExpr);
      const expNode = powerExpr.querySelector('.exp');
      placeCaretAtBeginning(expNode);
      isResult = false;
      lastOperator = null;
      // Set AC mode since we're inside a function
      isACMode = true;
      updateACBackspaceButton();
      return;
    }

    // *** FIX STARTS HERE ***
    // Check if the entire display contains a single, simple number
    const plainText = getPlainExpression(display).trim();
    if (/^[\d.]+$/.test(plainText) && !isNaN(parseFloat(plainText))) {
      // If so, use the entire number as the base.
      display.innerHTML = ''; // Clear the current display
      const powerExpr = createPowerExpr(plainText);
      display.appendChild(powerExpr);
      
      // Move the cursor into the new exponent box
      const expNode = powerExpr.querySelector('.exp');
      placeCaretAtBeginning(expNode);
      
      // Set AC mode as we are now inside a function
      isACMode = true;
      updateACBackspaceButton();
      return; // Exit after handling this primary case
    }
    // *** FIX ENDS HERE ***
    
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    let range = sel.getRangeAt(0);
    
    // If there's a selection, use it as the base
    if (!range.collapsed) {
      const selectedText = range.toString();
      // Create a power expression structure
      const powerExpr = createPowerExpr(selectedText);
      range.deleteContents();
      range.insertNode(powerExpr);
      // Move cursor to the exponent
      const expNode = powerExpr.querySelector('.exp');
      placeCaretAtBeginning(expNode);
    } else {
      // No selection: check if cursor is inside a number
      let node = range.startContainer;
      let offset = range.startOffset;
      
      // If the entire display is a single number, use it as the base
      if (node === display && display.childNodes.length === 1 && 
          display.childNodes[0].nodeType === Node.TEXT_NODE) {
        const number = display.childNodes[0].textContent;
        display.innerHTML = '';
        const powerExpr = createPowerExpr(number);
        display.appendChild(powerExpr);
        const expNode = powerExpr.querySelector('.exp');
        placeCaretAtBeginning(expNode);
      } else if (node.nodeType !== Node.TEXT_NODE) {
        // If not in a text node, insert a power expression with empty base and exponent
        const powerExpr = createPowerExpr('');
        range.insertNode(powerExpr);
        // Move cursor to the base
        const baseNode = powerExpr.querySelector('.base');
        placeCaretAtBeginning(baseNode);
      } else {
        const text = node.textContent;
        
        // Find the start and end of the current number at the cursor
        let start = offset;
        let end = offset;
        
        // Move start backwards until we hit a non-digit, non-dot, or the beginning
        while (start > 0 && /[\d.]/.test(text.charAt(start - 1))) {
          start--;
        }
        
        // Move end forwards until we hit a non-digit, non-dot, or the end
        while (end < text.length && /[\d.]/.test(text.charAt(end))) {
          end++;
        }
        
        // If we found a number (at least one digit)
        if (start < end && /\d/.test(text.substring(start, end))) {
          // Extract the number
          const number = text.substring(start, end);
          
          // Replace the number with a power expression
          const before = text.substring(0, start);
          const after = text.substring(end);
          
          // Create the power expression
          const powerExpr = createPowerExpr(number);
          
          // Create a new text node for the parts before and after
          const beforeNode = document.createTextNode(before);
          const afterNode = document.createTextNode(after);
          
          // Replace the current node with the new structure
          const parent = node.parentNode;
          parent.insertBefore(beforeNode, node);
          parent.insertBefore(powerExpr, node);
          parent.insertBefore(afterNode, node);
          parent.removeChild(node);
          
          // Move cursor to the exponent
          const expNode = powerExpr.querySelector('.exp');
          placeCaretAtBeginning(expNode);
        } else {
          // No number found, insert a power expression with empty base and exponent
          const powerExpr = createPowerExpr('');
          const before = text.substring(0, offset);
          const after = text.substring(offset);
          
          node.textContent = before;
          const parent = node.parentNode;
          parent.insertBefore(powerExpr, node.nextSibling);
          const afterNode = document.createTextNode(after);
          parent.insertBefore(afterNode, powerExpr.nextSibling);
          
          // Move cursor to the base
          const baseNode = powerExpr.querySelector('.base');
          placeCaretAtBeginning(baseNode);
        }
      }
    }
    
    // Set AC mode since we're inside a function
    isACMode = true;
    updateACBackspaceButton();
  }

  function createPowerExpr(baseText) {
    const powerExpr = document.createElement('span');
    powerExpr.className = 'power-expr';
    
    const baseSpan = document.createElement('span');
    baseSpan.className = 'base';
    baseSpan.contentEditable = true;
    baseSpan.textContent = baseText || '';
    
    // Create exponent box without dots
    const expSup = document.createElement('sup');
    expSup.className = 'exp';
    expSup.contentEditable = true;
    expSup.textContent = '';
    
    powerExpr.appendChild(baseSpan);
    powerExpr.appendChild(expSup);
    
    return powerExpr;
  }

  function insertEXPX() {
    // If we're starting a new operation after a result, clear the display
    if (isResult) {
      display.innerHTML = '';
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
    }
    
    // Clear display if it's just "0"
    if (display.innerText.trim() === '0') {
      display.innerHTML = '';
    }
    
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    let range = sel.getRangeAt(0);
    
    // Create e^x expression structure
    const expXExpr = createEXPXExpr();
    
    // Insert the structure
    range.insertNode(expXExpr);
    
    // Move cursor to the exponent
    const expNode = expXExpr.querySelector('.exp');
    placeCaretAtBeginning(expNode);
    
    // Set AC mode since we're inside a function
    isACMode = true;
    updateACBackspaceButton();
  }

  function createEXPXExpr() {
    const expXExpr = document.createElement('span');
    expXExpr.className = 'exp-x-expr';
    
    const baseSpan = document.createElement('span');
    baseSpan.className = 'base';
    baseSpan.contentEditable = false; // Base is fixed as 'e'
    baseSpan.textContent = 'e';
    baseSpan.style.fontStyle = 'italic'; // Italicize the 'e'
    
    // Create exponent box
    const expSup = document.createElement('sup');
    expSup.className = 'exp';
    expSup.contentEditable = true;
    expSup.textContent = ''; // Empty box instead of 'x'
    
    expXExpr.appendChild(baseSpan);
    expXExpr.appendChild(expSup);
    
    return expXExpr;
  }

  function insertSquare() {
    // If we're starting a new operation after a result, clear the display
    if (isResult) {
      display.innerHTML = '';
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
    }
    
    // Clear display if it's just "0"
    if (display.innerText.trim() === '0') {
      display.innerHTML = '';
    }
    
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    let range = sel.getRangeAt(0);
    
    // Check if the entire display is a number (only digits and decimal point)
    const plainText = getPlainExpression(display);
    if (/^[\d.]+$/.test(plainText)) {
      // Replace the entire display with the number followed by ² (without parentheses)
      display.innerHTML = plainText + "²";
      placeCaretAtEnd(display);
      
      // Set AC mode since we're inside a function
      isACMode = true;
      updateACBackspaceButton();
      return;
    }
    
    // If there's a selection, wrap it in parentheses with superscript 2
    if (!range.collapsed) {
      const selectedText = range.toString();
      const openingParen = document.createTextNode("(");
      const closingParen = document.createTextNode(")²");
      
      // Extract the selected content
      const selectedContent = range.extractContents();
      
      // Create a document fragment to hold the parentheses and selected content
      const frag = document.createDocumentFragment();
      frag.appendChild(openingParen);
      frag.appendChild(selectedContent);
      frag.appendChild(closingParen);
      
      // Insert the fragment
      range.insertNode(frag);
      
      // Move the cursor after the superscript 2
      range.setStartAfter(closingParen);
      range.collapse(true);
      sel.removeAllRanges();
      sel.addRange(range);
      // Save this position
      savedSelection = range;
    } else {
      // No selection: check if cursor is inside a number
      let node = range.startContainer;
      let offset = range.startOffset;
      
      if (node.nodeType !== Node.TEXT_NODE) {
        // If not in a text node, just insert "()²" with cursor inside
        insertTextAtCursor("()²");
        // Move cursor inside the parentheses
        const sel = window.getSelection();
        if (sel.rangeCount) {
          const range = sel.getRangeAt(0);
          // We need to move cursor back by 2 positions (to skip the closing parenthesis and superscript)
          if (range.startContainer.nodeType === Node.TEXT_NODE) {
            const textNode = range.startContainer;
            const currentOffset = range.startOffset;
            // Move cursor to position after opening parenthesis
            range.setStart(textNode, currentOffset - 2);
            range.collapse(true);
            sel.removeAllRanges();
            sel.addRange(range);
            // Save this position
            savedSelection = range;
          }
        }
      } else {
        const text = node.textContent;
        
        // Find the start and end of the current number at the cursor
        let start = offset;
        let end = offset;
        
        // Move start backwards until we hit a non-digit, non-dot, or the beginning
        while (start > 0 && /[\d.]/.test(text.charAt(start - 1))) {
          start--;
        }
        
        // Move end forwards until we hit a non-digit, non-dot, or the end
        while (end < text.length && /[\d.]/.test(text.charAt(end))) {
          end++;
        }
        
        // If we found a number (at least one digit)
        if (start < end && /\d/.test(text.substring(start, end))) {
          // Extract the number
          const number = text.substring(start, end);
          
          // Replace the number with number² (without parentheses)
          const before = text.substring(0, start);
          const after = text.substring(end);
          
          // Create a new text node for the squared number
          const newNode = document.createTextNode(before + number + "²" + after);
          node.parentNode.replaceChild(newNode, node);
          
          // Move the cursor after the superscript 2
          const newOffset = before.length + number.length + 1; // +1 for '²'
          setCaretPosition(newNode, newOffset);
        } else {
          // No number found, insert "()²" with cursor inside
          insertTextAtCursor("()²");
          // Move cursor inside the parentheses
          const sel = window.getSelection();
          if (sel.rangeCount) {
            const range = sel.getRangeAt(0);
            // We need to move cursor back by 2 positions (to skip the closing parenthesis and superscript)
            if (range.startContainer.nodeType === Node.TEXT_NODE) {
              const textNode = range.startContainer;
              const currentOffset = range.startOffset;
              // Move cursor to position after opening parenthesis
              range.setStart(textNode, currentOffset - 2);
              range.collapse(true);
              sel.removeAllRanges();
              sel.addRange(range);
              // Save this position
              savedSelection = range;
            }
          }
        }
      }
    }
    
    // Set AC mode since we're inside a function
    isACMode = true;
    updateACBackspaceButton();
  }

  function insertCube() {
    // If we're starting a new operation after a result, clear the display
    if (isResult) {
      display.innerHTML = '';
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
    }
    
    // Clear display if it's just "0"
    if (display.innerText.trim() === '0') {
      display.innerHTML = '';
    }
    
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    let range = sel.getRangeAt(0);
    
    // Check if the entire display is a number (only digits and decimal point)
    const plainText = getPlainExpression(display);
    if (/^[\d.]+$/.test(plainText)) {
      // Replace the entire display with the number followed by ³ (without parentheses)
      display.innerHTML = plainText + "³";
      placeCaretAtEnd(display);
      
      // Set AC mode since we're inside a function
      isACMode = true;
      updateACBackspaceButton();
      return;
    }
    
    // If there's a selection, wrap it in parentheses with superscript 3
    if (!range.collapsed) {
      const selectedText = range.toString();
      const openingParen = document.createTextNode("(");
      const closingParen = document.createTextNode(")³");
      
      // Extract the selected content
      const selectedContent = range.extractContents();
      
      // Create a document fragment to hold the parentheses and selected content
      const frag = document.createDocumentFragment();
      frag.appendChild(openingParen);
      frag.appendChild(selectedContent);
      frag.appendChild(closingParen);
      
      // Insert the fragment
      range.insertNode(frag);
      
      // Move the cursor after the superscript 3
      range.setStartAfter(closingParen);
      range.collapse(true);
      sel.removeAllRanges();
      sel.addRange(range);
      // Save this position
      savedSelection = range;
    } else {
      // No selection: check if cursor is inside a number
      let node = range.startContainer;
      let offset = range.startOffset;
      
      if (node.nodeType !== Node.TEXT_NODE) {
        // If not in a text node, just insert "()³" with cursor inside
        insertTextAtCursor("()³");
        // Move cursor inside the parentheses
        const sel = window.getSelection();
        if (sel.rangeCount) {
          const range = sel.getRangeAt(0);
          // We need to move cursor back by 2 positions (to skip the closing parenthesis and superscript)
          if (range.startContainer.nodeType === Node.TEXT_NODE) {
            const textNode = range.startContainer;
            const currentOffset = range.startOffset;
            // Move cursor to position after opening parenthesis
            range.setStart(textNode, currentOffset - 2);
            range.collapse(true);
            sel.removeAllRanges();
            sel.addRange(range);
            // Save this position
            savedSelection = range;
          }
        }
      } else {
        const text = node.textContent;
        
        // Find the start and end of the current number at the cursor
        let start = offset;
        let end = offset;
        
        // Move start backwards until we hit a non-digit, non-dot, or the beginning
        while (start > 0 && /[\d.]/.test(text.charAt(start - 1))) {
          start--;
        }
        
        // Move end forwards until we hit a non-digit, non-dot, or the end
        while (end < text.length && /[\d.]/.test(text.charAt(end))) {
          end++;
        }
        
        // If we found a number (at least one digit)
        if (start < end && /\d/.test(text.substring(start, end))) {
          // Extract the number
          const number = text.substring(start, end);
          
          // Replace the number with number³ (without parentheses)
          const before = text.substring(0, start);
          const after = text.substring(end);
          
          // Create a new text node for the cubed number
          const newNode = document.createTextNode(before + number + "³" + after);
          node.parentNode.replaceChild(newNode, node);
          
          // Move the cursor after the superscript 3
          const newOffset = before.length + number.length + 1; // +1 for '³'
          setCaretPosition(newNode, newOffset);
        } else {
          // No number found, insert "()³" with cursor inside
          insertTextAtCursor("()³");
          // Move cursor inside the parentheses
          const sel = window.getSelection();
          if (sel.rangeCount) {
            const range = sel.getRangeAt(0);
            // We need to move cursor back by 2 positions (to skip the closing parenthesis and superscript)
            if (range.startContainer.nodeType === Node.TEXT_NODE) {
              const textNode = range.startContainer;
              const currentOffset = range.startOffset;
              // Move cursor to position after opening parenthesis
              range.setStart(textNode, currentOffset - 2);
              range.collapse(true);
              sel.removeAllRanges();
              sel.addRange(range);
              // Save this position
              savedSelection = range;
            }
          }
        }
      }
    }
    
    // Set AC mode since we're inside a function
    isACMode = true;
    updateACBackspaceButton();
  }

  function insertRoot() {
    // If we're starting a new operation after a result, clear the display
    if (isResult) {
      display.innerHTML = '';
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
    }
    
    // Clear display if it's just "0"
    if (display.innerText.trim() === '0') {
      display.innerHTML = '';
    }
    
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    let range = sel.getRangeAt(0);
    
    // If there's a selection, wrap it with √()
    if (!range.collapsed) {
      const selectedContent = range.extractContents();
      const openingText = document.createTextNode("√(");
      const closingText = document.createTextNode(")");
      
      const frag = document.createDocumentFragment();
      frag.appendChild(openingText);
      frag.appendChild(selectedContent);
      frag.appendChild(closingText);
      
      range.insertNode(frag);
      
      // Move cursor inside the parentheses
      range.setStartAfter(openingText);
      range.collapse(true);
      sel.removeAllRanges();
      sel.addRange(range);
      // Save this position
      savedSelection = range;
    } else {
      // Check if cursor is inside existing parentheses
      let node = range.startContainer;
      let offset = range.startOffset;
      let text = '';
      
      if (node.nodeType === Node.TEXT_NODE) {
        text = node.textContent;
        
        // Check if cursor is right after "√("
        if (offset >= 2 && text.substring(offset - 2, offset) === "√(") {
          // We're inside an existing √(), insert nested √()
          const before = text.substring(0, offset);
          const after = text.substring(offset);
          
          const newNode = document.createTextNode(before + "√()" + after);
          node.parentNode.replaceChild(newNode, node);
          
          // Move cursor inside the nested parentheses
          setCaretPosition(newNode, offset + 2);
        } else {
          // Insert new √()
          const before = text.substring(0, offset);
          const after = text.substring(offset);
          
          const newNode = document.createTextNode(before + "√()" + after);
          node.parentNode.replaceChild(newNode, node);
          
          // Move cursor inside the parentheses
          setCaretPosition(newNode, offset + 2);
        }
      } else {
        // Not in a text node, just insert √()
        insertTextAtCursor("√()");
        
        // Move cursor inside the parentheses
        if (node.childNodes.length > 0) {
          const lastChild = node.childNodes[node.childNodes.length - 1];
          if (lastChild.nodeType === Node.TEXT_NODE) {
            setCaretPosition(lastChild, lastChild.length - 1);
          }
        }
      }
    }
    
    // Set AC mode since we're inside a function
    isACMode = true;
    updateACBackspaceButton();
  }

  function insertCubeRoot() {
    // If we're starting a new operation after a result, clear the display
    if (isResult) {
      display.innerHTML = '';
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
    }
    
    // Clear display if it's just "0"
    if (display.innerText.trim() === '0') {
      display.innerHTML = '';
    }
    
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    let range = sel.getRangeAt(0);
    
    // If there's a selection, wrap it with ³√()
    if (!range.collapsed) {
      const selectedContent = range.extractContents();
      const openingText = document.createTextNode("³√(");
      const closingText = document.createTextNode(")");
      
      const frag = document.createDocumentFragment();
      frag.appendChild(openingText);
      frag.appendChild(selectedContent);
      frag.appendChild(closingText);
      
      range.insertNode(frag);
      
      // Move cursor inside the parentheses
      range.setStartAfter(openingText);
      range.collapse(true);
      sel.removeAllRanges();
      sel.addRange(range);
      // Save this position
      savedSelection = range;
    } else {
      // Check if cursor is inside existing parentheses
      let node = range.startContainer;
      let offset = range.startOffset;
      let text = '';
      
      if (node.nodeType === Node.TEXT_NODE) {
        text = node.textContent;
        
        // Check if cursor is right after "³√("
        if (offset >= 3 && text.substring(offset - 3, offset) === "³√(") {
          // We're inside an existing ³√(), insert nested ³√()
          const before = text.substring(0, offset);
          const after = text.substring(offset);
          
          const newNode = document.createTextNode(before + "³√()" + after);
          node.parentNode.replaceChild(newNode, node);
          
          // Move cursor inside the nested parentheses
          setCaretPosition(newNode, offset + 3);
        } else {
          // Insert new ³√()
          const before = text.substring(0, offset);
          const after = text.substring(offset);
          
          const newNode = document.createTextNode(before + "³√()" + after);
          node.parentNode.replaceChild(newNode, node);
          
          // Move cursor inside the parentheses
          setCaretPosition(newNode, offset + 3);
        }
      } else {
        // Not in a text node, just insert ³√()
        insertTextAtCursor("³√()");
        
        // Move cursor inside the parentheses
        if (node.childNodes.length > 0) {
          const lastChild = node.childNodes[node.childNodes.length - 1];
          if (lastChild.nodeType === Node.TEXT_NODE) {
            setCaretPosition(lastChild, lastChild.length - 1);
          }
        }
      }
    }
    
    // Set AC mode since we're inside a function
    isACMode = true;
    updateACBackspaceButton();
  }

  function insertScientificNotation() {
    // If we're starting a new operation after a result, clear the display
    if (isResult) {
      display.innerHTML = '';
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
    }
    
    // Clear display if it's just "0"
    if (display.innerText.trim() === '0') {
      display.innerHTML = '';
    }
    
    // Change AC to Backspace when user starts typing
    if (isACMode) {
      isACMode = false;
      updateACBackspaceButton();
    }
    
    insertTextAtCursor('E');
    focusDisplay();
  }

  function applySciFunc(func) {
    // If we're starting a new operation after a result, clear the display
    if (isResult) {
      display.innerHTML = '';
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
    }
    
    // Clear display if it's just "0"
    if (display.innerText.trim() === '0') {
      display.innerHTML = '';
    }
    
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    let range = sel.getRangeAt(0);
    
    if (func === 'inverse') {
      // Handle 1/x function
      if (!range.collapsed) {
        // If there's a selection, wrap it with 1/()
        const selectedContent = range.extractContents();
        const openingText = document.createTextNode("1/(");
        const closingText = document.createTextNode(")");
        
        const frag = document.createDocumentFragment();
        frag.appendChild(openingText);
        frag.appendChild(selectedContent);
        frag.appendChild(closingText);
        
        range.insertNode(frag);
        
        // Move cursor inside the parentheses
        range.setStartAfter(openingText);
        range.collapse(true);
        sel.removeAllRanges();
        sel.addRange(range);
        // Save this position
        savedSelection = range;
      } else {
        // Check if cursor is inside existing parentheses
        let node = range.startContainer;
        let offset = range.startOffset;
        let text = '';
        
        if (node.nodeType === Node.TEXT_NODE) {
          text = node.textContent;
          
          // Check if cursor is right after "1/("
          if (offset >= 3 && text.substring(offset - 3, offset) === "1/(") {
            // We're inside an existing 1/(), insert nested 1/()
            const before = text.substring(0, offset);
            const after = text.substring(offset);
            
            const newNode = document.createTextNode(before + "1/()" + after);
            node.parentNode.replaceChild(newNode, node);
            
            // Move cursor inside the nested parentheses
            setCaretPosition(newNode, offset + 3);
          } else {
            // Insert new 1/()
            const before = text.substring(0, offset);
            const after = text.substring(offset);
            
            const newNode = document.createTextNode(before + "1/()" + after);
            node.parentNode.replaceChild(newNode, node);
            
            // Move cursor inside the parentheses
            setCaretPosition(newNode, offset + 3);
          }
        } else {
          // Not in a text node, just insert 1/()
          insertTextAtCursor("1/()");
          
          // Move cursor inside the parentheses
          if (node.childNodes.length > 0) {
            const lastChild = node.childNodes[node.childNodes.length - 1];
            if (lastChild.nodeType === Node.TEXT_NODE) {
              setCaretPosition(lastChild, lastChild.length - 1);
            }
          }
        }
      }
    } else if (func === 'abs') {
      // Handle abs function
      if (!range.collapsed) {
        // If there's a selection, wrap it with abs()
        const selectedContent = range.extractContents();
        const openingText = document.createTextNode("abs(");
        const closingText = document.createTextNode(")");
        
        const frag = document.createDocumentFragment();
        frag.appendChild(openingText);
        frag.appendChild(selectedContent);
        frag.appendChild(closingText);
        
        range.insertNode(frag);
        
        // Move cursor inside the parentheses
        range.setStartAfter(openingText);
        range.collapse(true);
        sel.removeAllRanges();
        sel.addRange(range);
        // Save this position
        savedSelection = range;
      } else {
        // Check if cursor is inside existing parentheses
        let node = range.startContainer;
        let offset = range.startOffset;
        let text = '';
        
        if (node.nodeType === Node.TEXT_NODE) {
          text = node.textContent;
          
          // Check if cursor is right after "abs("
          if (offset >= 4 && text.substring(offset - 4, offset) === "abs(") {
            // We're inside an existing abs(), insert nested abs()
            const before = text.substring(0, offset);
            const after = text.substring(offset);
            
            const newNode = document.createTextNode(before + "abs()" + after);
            node.parentNode.replaceChild(newNode, node);
            
            // Move cursor inside the nested parentheses
            setCaretPosition(newNode, offset + 4);
          } else {
            // Insert new abs()
            const before = text.substring(0, offset);
            const after = text.substring(offset);
            
            const newNode = document.createTextNode(before + "abs()" + after);
            node.parentNode.replaceChild(newNode, node);
            
            // Move cursor inside the parentheses
            setCaretPosition(newNode, offset + 4);
          }
        } else {
          // Not in a text node, just insert abs()
          insertTextAtCursor("abs()");
          
          // Move cursor inside the parentheses
          if (node.childNodes.length > 0) {
            const lastChild = node.childNodes[node.childNodes.length - 1];
            if (lastChild.nodeType === Node.TEXT_NODE) {
              setCaretPosition(lastChild, lastChild.length - 1);
            }
          }
        }
      }
    }
    
    // Set AC mode since we're inside a function
    isACMode = true;
    updateACBackspaceButton();
  }

  function insertFactorial() {
    // If we're starting a new operation after a result, clear the display
    if (isResult) {
      display.innerHTML = '';
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
    }
    
    // Change AC to Backspace when user starts typing
    if (isACMode) {
      isACMode = false;
      updateACBackspaceButton();
    }
    
    focusDisplay();
    const sel = window.getSelection();
    if (!sel.rangeCount) return;
    let range = sel.getRangeAt(0);
    
    // If there's a selection, add factorial after the selection
    if (!range.collapsed) {
      const selectedText = range.toString();
      const factorialNode = document.createTextNode("!");
      
      // Extract the selected content
      const selectedContent = range.extractContents();
      
      // Create a document fragment to hold the selected content and factorial
      const frag = document.createDocumentFragment();
      frag.appendChild(selectedContent);
      frag.appendChild(factorialNode);
      
      // Insert the fragment
      range.insertNode(frag);
      
      // Move the cursor after the factorial
      range.setStartAfter(factorialNode);
      range.collapse(true);
      sel.removeAllRanges();
      sel.addRange(range);
      // Save this position
      savedSelection = range;
      return;
    }
    
    // No selection: check if cursor is inside a number
    let node = range.startContainer;
    let offset = range.startOffset;
    
    if (node.nodeType !== Node.TEXT_NODE) {
      // If not in a text node, just insert "!"
      insertTextAtCursor("!");
      return;
    }
    
    const text = node.textContent;
    
    // Find the start and end of the current number at the cursor
    let start = offset;
    let end = offset;
    
    // Move start backwards until we hit a non-digit, non-dot, or the beginning
    while (start > 0 && /[\d.]/.test(text.charAt(start - 1))) {
      start--;
    }
    
    // Move end forwards until we hit a non-digit, non-dot, or the end
    while (end < text.length && /[\d.]/.test(text.charAt(end))) {
      end++;
    }
    
    // If we found a number (at least one digit)
    if (start < end && /\d/.test(text.substring(start, end))) {
      // Extract the number
      const number = text.substring(start, end);
      
      // Replace the number with number!
      const before = text.substring(0, start);
      const after = text.substring(end);
      
      // Create a new text node for the factorial number
      const newNode = document.createTextNode(before + number + "!" + after);
      node.parentNode.replaceChild(newNode, node);
      
      // Move the cursor after the factorial
      const newOffset = before.length + number.length + 1; // +1 for '!'
      setCaretPosition(newNode, newOffset);
    } else {
      // No number found, just insert "!"
      insertTextAtCursor("!");
    }
  }

  function isParenthesesBalanced(expr) {
    let stack = [];
    for (let char of expr) {
      if (char === '(') stack.push(char);
      else if (char === ')') {
        if (!stack.length) return false;
        stack.pop();
      }
    }
    return stack.length === 0;
  }

  function autoCloseParentheses(expr) {
    let stack = [];
    let result = '';
    
    for (let char of expr) {
      if (char === '(') {
        stack.push(result.length);
        result += char;
      } else if (char === ')') {
        if (stack.length > 0) {
          stack.pop();
          result += char;
        } else {
          // Extra closing parenthesis, ignore it
        }
      } else {
        result += char;
      }
    }
    
    // Add missing closing parentheses
    while (stack.length > 0) {
      result += ')';
      stack.pop();
    }
    
    return result;
  }

  function convertPowerExpressions(expr) {
    // Process the expression from right to left to handle nested expressions correctly
    let result = '';
    let i = expr.length - 1;
    
    while (i >= 0) {
      if (i >= 1 && (expr.substr(i-1, 2) === ')²' || expr.substr(i-1, 2) === ')³')) {
        // Found a power expression, find the matching opening parenthesis
        let power = expr[i] === '²' ? '2' : '3';
        let depth = 0;
        let j = i - 2; // Start before the )² or )³
        
        // Find the matching opening parenthesis
        while (j >= 0) {
          if (expr[j] === ')') depth++;
          else if (expr[j] === '(') {
            if (depth === 0) break;
            depth--;
          }
          j--;
        }
        
        if (j >= 0) {
          // Found matching opening parenthesis
          let content = expr.substring(j+1, i-1);
          // Recursively process the content to handle nested power expressions
          content = convertPowerExpressions(content);
          result = `pow(${content},${power})` + result;
          i = j - 1; // Skip the opening parenthesis
        } else {
          // No matching opening parenthesis, just append the characters
          result = expr[i] + result;
          i--;
        }
      } else {
        result = expr[i] + result;
        i--;
      }
    }
    
    return result;
  }

  function calculate() {
    try {
      // Get the expression by traversing the DOM to properly handle all structures
      let expr = convertDisplayToMathExpression();
      if (!expr) return;
      
      // Save the original expression exactly as displayed
      const originalExpression = display.innerHTML;
      
      expr = autoCloseParentheses(expr);
      if (!isParenthesesBalanced(expr)) {
        display.innerHTML = 'Lỗi: Dấu ngoặc không khớp';
        expression.innerHTML = '';
        focusDisplay();
        placeCaretAtEnd(display);
        return;
      }
      
      // Replace ln with log (natural logarithm)
      expr = expr.replace(/ln\s*\(/g, 'log(');
      
      expr = expr
        .replace(/π/g, 'pi')
        .replace(/e/g, 'e')
        .replace(/³√/g, 'cbrt')   // First replace cube root
        .replace(/√/g, 'sqrt')    // Then replace square root
        .replace(/×/g, '*')
        .replace(/÷/g, '/');
      
      // Handle the (number)² and (number)³ formats with nested parentheses
      expr = convertPowerExpressions(expr);
      
      // Handle direct superscripts like 555²
      expr = expr.replace(/(\d+(\.\d+)?)²/g, 'pow($1,2)');
      expr = expr.replace(/(\d+(\.\d+)?)³/g, 'pow($1,3)');
      
      // Handle factorial without parentheses
      expr = expr.replace(/(\d+)!/g, 'factorial($1)');
      // Handle factorial with parentheses
      expr = expr.replace(/\(([^)]+)\)!/g, 'factorial($1)');
      // Fixed log replacement to handle nested functions
      expr = expr.replace(/log\s*\(/g, 'log10(');
      expr = expr.replace(/abs\(/g, 'abs(');
      expr = expr.replace(/(\d+)E(\d+)/g, '$1e$2');
      expr = expr.replace(/(\d+(\.\d+)?)%/g, '($1/100)');

      expr = replaceTrigFunctions(expr);
      expr = expr.replace(/\b(sin|cos|tan|asin|acos|atan|sqrt|log|ln|abs|fact)\(\s*\)/g, '0');

      const result = math.evaluate(expr);
      if (typeof result === 'number' && !isNaN(result)) {
        // Display the expression above the result
        expression.innerHTML = originalExpression;
        display.innerHTML = result;
        // Save the original expression (as HTML) and the result
        history.push({ expression: originalExpression, result: result });
        isResult = true;
        lastOperator = null;
        // Switch back to AC mode after calculation
        isACMode = true;
        updateACBackspaceButton();
      } else {
        if (result && (result.re !== undefined || result.im !== undefined)) {
          expression.innerHTML = originalExpression;
          display.innerHTML = result.toString();
          history.push({ expression: originalExpression, result: result.toString() });
          isResult = true;
          lastOperator = null;
          // Switch back to AC mode after calculation
          isACMode = true;
          updateACBackspaceButton();
        } else {
          display.innerHTML = 'Lỗi: Kết quả không hợp lệ';
          expression.innerHTML = '';
          isResult = false;
          lastOperator = null;
          // Switch back to AC mode after error
          isACMode = true;
          updateACBackspaceButton();
        }
      }
    } catch (e) {
      display.innerHTML = 'Lỗi: ' + e.message;
      expression.innerHTML = '';
      isResult = false;
      lastOperator = null;
      // Switch back to AC mode after error
      isACMode = true;
      updateACBackspaceButton();
    }
    focusDisplay();
    placeCaretAtEnd(display);
  }

  // New function to convert display to math expression by traversing DOM
  function convertDisplayToMathExpression() {
    let result = '';
    
    function processNode(node) {
      if (node.nodeType === Node.TEXT_NODE) {
        let text = node.textContent;
        // Handle inverse trig functions by replacing special characters
        text = text.replace(/sin⁻¹/g, 'asin')
                  .replace(/cos⁻¹/g, 'acos')
                  .replace(/tan⁻¹/g, 'atan');
        result += text;
      } else if (node.classList && node.classList.contains('power-expr')) {
        const baseNode = node.querySelector('.base');
        const expNode = node.querySelector('.exp');
        
        if (baseNode && expNode) {
          // Get the text content directly
          const base = baseNode.textContent || '0';
          const exp = expNode.textContent || '0';
          
          // Validate that both base and exponent are not empty
          if (base.trim() === '' || exp.trim() === '') {
            // If either is empty, use default values
            result += `pow(${base || '0'},${exp || '0'})`;
          } else {
            // Check if they are valid numbers
            const baseNum = parseFloat(base);
            const expNum = parseFloat(exp);
            
            if (isNaN(baseNum) || isNaN(expNum)) {
              // If they are not valid numbers, treat them as variables
              result += `pow(${base},${exp})`;
            } else {
              // If they are valid numbers, use them directly
              result += `pow(${baseNum},${expNum})`;
            }
          }
        }
        return; // Skip processing children of power-expr
      } else if (node.classList && node.classList.contains('exp-x-expr')) {
        const expNode = node.querySelector('.exp');
        
        if (expNode) {
          // Get the exponent content
          const exponent = expNode.textContent || '0';
          
          // Convert to exp(exponent) format
          result += `exp(${exponent})`;
        }
        return; // Skip processing children of exp-x-expr
      } else {
        // Process child nodes
        for (let i = 0; i < node.childNodes.length; i++) {
          processNode(node.childNodes[i]);
        }
      }
    }
    
    processNode(display);
    return result;
  }

  function convertPowerBlocks(expr) {
    // This function is now replaced by convertDisplayToMathExpression
    return expr;
  }

  // Optimized parser for trig functions
  function replaceTrigFunctions(expr) {
    const funcs = {
      sin: { deg: v => `sin((${v}) * pi / 180)`, rad: v => `sin(${v})` },
      cos: { deg: v => `cos((${v}) * pi / 180)`, rad: v => `cos(${v})` },
      tan: { deg: v => `tan((${v}) * pi / 180)`, rad: v => `tan(${v})` },
      asin: { deg: v => `(asin(${v}) * 180 / pi)`, rad: v => `asin(${v})` },
      acos: { deg: v => `(acos(${v}) * 180 / pi)`, rad: v => `acos(${v})` },
      atan: { deg: v => `(atan(${v}) * 180 / pi)`, rad: v => `atan(${v})` }
    };

    // Use a more efficient approach with regex replacements
    const funcPattern = /(?:sin|cos|tan|asin|acos|atan)\s*\([^)]*\)/g;
    let result = '';
    let lastIndex = 0;
    let match;
    
    while ((match = funcPattern.exec(expr)) !== null) {
      // Add the part before the match
      result += expr.substring(lastIndex, match.index);
      
      // Process the matched function
      const funcMatch = match[0];
      const funcName = funcMatch.match(/^(sin|cos|tan|asin|acos|atan)/)[1];
      const innerExpr = funcMatch.substring(funcName.length + 1, funcMatch.length - 1);
      
      // Apply the appropriate conversion
      const conversion = funcs[funcName][angleMode];
      result += conversion(innerExpr);
      
      lastIndex = funcPattern.lastIndex;
    }
    
    // Add the remaining part of the expression
    result += expr.substring(lastIndex);
    
    return result;
  }

  function getPlainExpression(el) {
    let text = el.innerText || el.textContent;
    if (!text) return null;
    return text;
  }

  function openHistory() {
    if (history.length === 0) {
      // Enhanced message for empty history
      historyContent.innerHTML = `
        <div style="text-align: center; padding: 20px; color: #666;">
          <i class="fas fa-history" style="font-size: 24px; margin-bottom: 10px; display: block;"></i>
          <p>Chưa có lịch sử tính toán nào.</p>
          <p style="font-size: 14px; margin-top: 5px;">Hãy thực hiện một phép tính để xem lịch sử tại đây.</p>
        </div>
      `;
    } else {
      // Enhanced history display with heading
      historyContent.innerHTML = `
        <div style="margin-bottom: 15px; font-weight: 500; color: #333;">
          <i class="fas fa-history" style="margin-right: 8px;"></i>
          Lịch sử tính toán gần đây
        </div>
      `;
      
      history.forEach((item, index) => {
        const historyItem = document.createElement('div');
        historyItem.className = 'history-item';
        historyItem.tabIndex = 0;
        historyItem.onclick = () => loadFromHistory(index);
        
        // Create a container for the expression
        const exprContainer = document.createElement('span');
        
        // Parse the expression HTML and convert power expressions to a readable format
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = item.expression;
        
        function processNode(node) {
          if (node.nodeType === Node.TEXT_NODE) {
            return document.createTextNode(node.textContent);
          }
          
          if (node.classList && node.classList.contains('power-expr')) {
            const powerElement = document.createElement('span');
            powerElement.className = 'history-power';
            
            const baseElement = document.createElement('span');
            baseElement.className = 'base';
            baseElement.textContent = node.querySelector('.base')?.textContent || '0';
            
            const expElement = document.createElement('span');
            expElement.className = 'exp';
            expElement.textContent = node.querySelector('.exp')?.textContent || '0';
            
            powerElement.appendChild(baseElement);
            powerElement.appendChild(expElement);
            
            return powerElement;
          } else if (node.classList && node.classList.contains('exp-x-expr')) {
            // Handle e^x expressions in history
            const expXElement = document.createElement('span');
            expXElement.className = 'history-power';
            
            const baseElement = document.createElement('span');
            baseElement.className = 'base';
            baseElement.textContent = 'e';
            baseElement.style.fontStyle = 'italic';
            
            const expElement = document.createElement('span');
            expElement.className = 'exp';
            expElement.textContent = node.querySelector('.exp')?.textContent || 'x';
            
            expXElement.appendChild(baseElement);
            expXElement.appendChild(expElement);
            
            return expXElement;
          }
          
          // Clone other nodes
          const clone = node.cloneNode(false);
          
          // Process children
          Array.from(node.childNodes).forEach(child => {
            clone.appendChild(processNode(child));
          });
          
          return clone;
        }
        
        // Process all nodes in the expression
        Array.from(tempDiv.childNodes).forEach(child => {
          exprContainer.appendChild(processNode(child));
        });
        
        // Create the equals sign and result
        const equalsText = document.createTextNode(' = ');
        const resultText = document.createTextNode(item.result);
        
        historyItem.appendChild(exprContainer);
        historyItem.appendChild(equalsText);
        historyItem.appendChild(resultText);
        
        historyContent.appendChild(historyItem);
      });
    }
    
    // Show modal with a slight delay for better rendering
    setTimeout(() => {
      historyModal.classList.add('active');
      // Focus on modal content after a delay
      setTimeout(() => {
        historyContent.focus();
      }, 100);
    }, 10);
  }

  function closeHistory() {
    historyModal.classList.remove('active');
    restoreCursorPosition();
  }

  function loadFromHistory(index) {
    const item = history[index];
    display.innerHTML = item.expression;
    expression.innerHTML = '';
    isResult = false;
    lastOperator = null;
    // Switch to backspace mode when loading from history
    isACMode = false;
    updateACBackspaceButton();
    closeHistory();
    focusDisplay();
    placeCaretAtEnd(display);
  }

  angleRadios.forEach(radio => {
    radio.addEventListener('change', () => {
      angleMode = radio.value;
    });
  });

  document.addEventListener('keydown', function(e) {
    if (document.activeElement === display) {
      return;
    }
    if (e.key >= '0' && e.key <= '9') {
      insertChar(e.key);
      e.preventDefault();
    } else if (e.key === '.') {
      insertChar('.');
      e.preventDefault();
    } else if (e.key === '+' || e.key === '-' || e.key === '*' || e.key === '/') {
      insertChar(e.key);
      e.preventDefault();
    } else if (e.key === 'Enter' || e.key === '=') {
      calculate();
      e.preventDefault();
    } else if (e.key === 'Escape') {
      clearAll();
      e.preventDefault();
    } else if (e.key === 'Backspace') {
      backspace();
      e.preventDefault();
    } else if (e.key === '(') {
      insertChar('(');
      e.preventDefault();
    } else if (e.key === ')') {
      insertChar(')');
      e.preventDefault();
    } else if (e.key === '%') {
      insertChar('%');
      e.preventDefault();
    } else if (e.key === '!') {
      insertFactorial();
      e.preventDefault();
    }
  });

 
  // Save cursor position when display loses focus
  display.addEventListener('blur', function() {
    saveCursorPosition();
  });

  // Restore cursor position when display gets focus
  display.addEventListener('focus', function() {
    restoreCursorPosition();
  });

  // Add click event to close modal when clicking outside
  document.getElementById('historyModal').addEventListener('click', function(e) {
    if (e.target === this) {
      closeHistory();
    }
  });

  // Initialize calculator on page load
  window.addEventListener('load', function() {
    initializeCalculator();
    display.focus();
    placeCaretAtEnd(display);
  });

  function clearAll() {
    display.innerHTML = '0';
    expression.innerHTML = '';
    isResult = false;
    lastOperator = null;
    isACMode = true; // Set to AC mode
    updateACBackspaceButton(); // Update the button text
    focusDisplay();
    placeCaretAtEnd(display);
  }
    </script>
</body>
</html>
